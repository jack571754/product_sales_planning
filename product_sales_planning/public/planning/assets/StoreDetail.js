var We=Object.defineProperty,Ye=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var Ve=(s,a,e)=>a in s?We(s,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[a]=e,R=(s,a)=>{for(var e in a||(a={}))et.call(a,e)&&Ve(s,e,a[e]);if(Te)for(var e of Te(a))tt.call(a,e)&&Ve(s,e,a[e]);return s},Ae=(s,a)=>Ye(s,Ze(a));var H=(s,a,e)=>new Promise((p,o)=>{var d=u=>{try{i(e.next(u))}catch(v){o(v)}},g=u=>{try{i(e.throw(u))}catch(v){o(v)}},i=u=>u.done?p(u.value):Promise.resolve(u.value).then(d,g);i((e=e.apply(s,a)).next())});import{c as b,o as n,a as l,d as G,m as st,u as at,b as C,L as lt,e as O,n as J,r as N,f as P,g as ot,t as w,h as m,i as t,j as Le,k as nt,l as rt,p as B,q as it,s as ue,w as f,v as Q,P as Oe,x as qe,y as De,z as Me,D as ut,A as dt,F as ct,B as Ee,C as pt,E as je,G as ft,H as Be,I as Fe,T as mt,_ as ne,J as gt,K as Pe,M as D,N as vt,O as yt,Q as ht,R as Re,S as A,U as M,V as te,W as ie,X as bt,Y as _t,Z as xt,$ as se,a0 as ve,a1 as Ie,a2 as ee,a3 as j,a4 as kt,a5 as wt,a6 as Ct,a7 as $t,a8 as St}from"./index.js";const It={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ot(s,a){return n(),b("svg",It,[...a[0]||(a[0]=[l("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"m15 9l-6 6m0-6l6 6"})],-1)])])}const Dt={name:"lucide-circle-x",render:Ot},Pt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function zt(s,a){return n(),b("svg",Pt,[...a[0]||(a[0]=[l("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"m9 12l2 2l4-4"})],-1)])])}const Et={name:"lucide-circle-check",render:zt},Bt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ft(s,a){return n(),b("svg",Bt,[...a[0]||(a[0]=[l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m21.73 18l-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3M12 9v4m0 4h.01"},null,-1)])])}const Tt={name:"lucide-triangle-alert",render:Ft},Vt={class:"text-ink-gray-9"},At={key:0,class:"text-ink-gray-6 prose-sm"},ze=G({__name:"Alert",props:st({title:{},theme:{},variant:{default:"subtle"},description:{},dismissable:{type:Boolean,default:!0}},{modelValue:{default:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const a=at(s,"modelValue"),e=C(()=>{const d={yellow:"bg-surface-amber-2",blue:"bg-surface-blue-2",red:"bg-surface-red-2",green:"bg-surface-green-2"};return o.variant=="outline"?"border border-outline-gray-3":o.theme?d[o.theme]:"bg-surface-gray-2"}),p=C(()=>{const d={yellow:{component:Tt,css:"text-ink-amber-3"},blue:{component:lt,css:"text-ink-blue-3"},red:{component:Dt,css:"text-ink-red-3"},green:{component:Et,css:"text-ink-green-3"}};return o.theme?d[o.theme]:null}),o=s;return(d,g)=>a.value?(n(),b("div",{key:0,role:"alert",class:J([e.value,"grid grid-cols-[auto_1fr_auto] gap-3 rounded-md px-4 py-3.5 text-base items-start"])},[N(d.$slots,"icon",{},()=>[p.value?(n(),P(ot(p.value.component),{key:0,class:J(["size-4",p.value.css])},null,8,["class"])):O("",!0)]),l("div",{class:J(["grid gap-2",{"col-span-2":!d.$slots.icon&&!p.value}])},[l("span",Vt,w(o.title),1),N(d.$slots,"description",{},()=>[o.description?(n(),b("p",At,w(o.description),1)):O("",!0)])],2),o.dismissable?(n(),b("button",{key:0,onClick:g[0]||(g[0]=i=>a.value=!1)},[m(t(Le),{class:"size-4"})])):O("",!0),N(d.$slots,"footer")],2)):O("",!0)}}),[de,qt]=nt("DialogRoot");var Mt=G({inheritAttrs:!1,__name:"DialogRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1,default:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(s,{emit:a}){const e=s,o=rt(e,"open",a,{defaultValue:e.defaultOpen,passive:e.open===void 0}),d=B(),g=B(),{modal:i}=it(e);return qt({open:o,modal:i,openModal:()=>{o.value=!0},onOpenChange:u=>{o.value=u},onOpenToggle:()=>{o.value=!o.value},contentId:"",titleId:"",descriptionId:"",triggerElement:d,contentElement:g}),(u,v)=>N(u.$slots,"default",{open:t(o),close:()=>o.value=!1})}}),Nt=Mt,Ut=G({__name:"DialogClose",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(s){const a=s;ue();const e=de();return(p,o)=>(n(),P(t(Oe),Q(a,{type:p.as==="button"?"button":void 0,onClick:o[0]||(o[0]=d=>t(e).onOpenChange(!1))}),{default:f(()=>[N(p.$slots,"default")]),_:3},16,["type"]))}}),Lt=Ut,jt=G({__name:"DialogContentImpl",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(s,{emit:a}){const e=s,p=a,o=de(),{forwardRef:d,currentElement:g}=ue();return o.titleId||(o.titleId=qe(void 0,"reka-dialog-title")),o.descriptionId||(o.descriptionId=qe(void 0,"reka-dialog-description")),De(()=>{o.contentElement=g,Me()!==document.body&&(o.triggerElement.value=Me())}),(i,u)=>(n(),P(t(ct),{"as-child":"",loop:"",trapped:e.trapFocus,onMountAutoFocus:u[5]||(u[5]=v=>p("openAutoFocus",v)),onUnmountAutoFocus:u[6]||(u[6]=v=>p("closeAutoFocus",v))},{default:f(()=>[m(t(ut),Q({id:t(o).contentId,ref:t(d),as:i.as,"as-child":i.asChild,"disable-outside-pointer-events":i.disableOutsidePointerEvents,role:"dialog","aria-describedby":t(o).descriptionId,"aria-labelledby":t(o).titleId,"data-state":t(dt)(t(o).open.value)},i.$attrs,{onDismiss:u[0]||(u[0]=v=>t(o).onOpenChange(!1)),onEscapeKeyDown:u[1]||(u[1]=v=>p("escapeKeyDown",v)),onFocusOutside:u[2]||(u[2]=v=>p("focusOutside",v)),onInteractOutside:u[3]||(u[3]=v=>p("interactOutside",v)),onPointerDownOutside:u[4]||(u[4]=v=>p("pointerDownOutside",v))}),{default:f(()=>[N(i.$slots,"default")]),_:3},16,["id","as","as-child","disable-outside-pointer-events","aria-describedby","aria-labelledby","data-state"])]),_:3},8,["trapped"]))}}),Ke=jt,Rt=G({__name:"DialogContentModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(s,{emit:a}){const e=s,p=a,o=de(),d=Ee(p),{forwardRef:g,currentElement:i}=ue();return pt(i),(u,v)=>(n(),P(Ke,Q(R(R({},e),t(d)),{ref:t(g),"trap-focus":t(o).open.value,"disable-outside-pointer-events":!0,onCloseAutoFocus:v[0]||(v[0]=x=>{var _;x.defaultPrevented||(x.preventDefault(),(_=t(o).triggerElement.value)==null||_.focus())}),onPointerDownOutside:v[1]||(v[1]=x=>{const _=x.detail.originalEvent,I=_.button===0&&_.ctrlKey===!0;(_.button===2||I)&&x.preventDefault()}),onFocusOutside:v[2]||(v[2]=x=>{x.preventDefault()})}),{default:f(()=>[N(u.$slots,"default")]),_:3},16,["trap-focus"]))}}),Kt=Rt,Ht=G({__name:"DialogContentNonModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(s,{emit:a}){const e=s,o=Ee(a);ue();const d=de(),g=B(!1),i=B(!1);return(u,v)=>(n(),P(Ke,Q(R(R({},e),t(o)),{"trap-focus":!1,"disable-outside-pointer-events":!1,onCloseAutoFocus:v[0]||(v[0]=x=>{var _;x.defaultPrevented||(g.value||(_=t(d).triggerElement.value)==null||_.focus(),x.preventDefault()),g.value=!1,i.value=!1}),onInteractOutside:v[1]||(v[1]=x=>{var y;x.defaultPrevented||(g.value=!0,x.detail.originalEvent.type==="pointerdown"&&(i.value=!0));const _=x.target;((y=t(d).triggerElement.value)==null?void 0:y.contains(_))&&x.preventDefault(),x.detail.originalEvent.type==="focusin"&&i.value&&x.preventDefault()})}),{default:f(()=>[N(u.$slots,"default")]),_:3},16))}}),Jt=Ht,Xt=G({__name:"DialogContent",props:{forceMount:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(s,{emit:a}){const e=s,p=a,o=de(),d=Ee(p),{forwardRef:g}=ue();return(i,u)=>(n(),P(t(je),{present:i.forceMount||t(o).open.value},{default:f(()=>[t(o).modal.value?(n(),P(Kt,Q({key:0,ref:t(g)},R(R(R({},e),t(d)),i.$attrs)),{default:f(()=>[N(i.$slots,"default")]),_:3},16)):(n(),P(Jt,Q({key:1,ref:t(g)},R(R(R({},e),t(d)),i.$attrs)),{default:f(()=>[N(i.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Qt=Xt,Gt=G({__name:"DialogDescription",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"p"}},setup(s){const a=s;ue();const e=de();return(p,o)=>(n(),P(t(Oe),Q(a,{id:t(e).descriptionId}),{default:f(()=>[N(p.$slots,"default")]),_:3},16,["id"]))}}),He=Gt,Wt=G({__name:"DialogOverlayImpl",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(s){const a=de();return ft(!0),ue(),(e,p)=>(n(),P(t(Oe),{as:e.as,"as-child":e.asChild,"data-state":t(a).open.value?"open":"closed",style:{"pointer-events":"auto"}},{default:f(()=>[N(e.$slots,"default")]),_:3},8,["as","as-child","data-state"]))}}),Yt=Wt,Zt=G({__name:"DialogOverlay",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(s){const a=de(),{forwardRef:e}=ue();return(p,o)=>{var d;return(d=t(a))!=null&&d.modal.value?(n(),P(t(je),{key:0,present:p.forceMount||t(a).open.value},{default:f(()=>[m(Yt,Q(p.$attrs,{ref:t(e),as:p.as,"as-child":p.asChild}),{default:f(()=>[N(p.$slots,"default")]),_:3},16,["as","as-child"])]),_:3},8,["present"])):O("v-if",!0)}}}),es=Zt,ts=G({__name:"DialogPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(s){const a=s;return(e,p)=>(n(),P(t(mt),Be(Fe(a)),{default:f(()=>[N(e.$slots,"default")]),_:3},16))}}),ss=ts,as=G({__name:"DialogTitle",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h2"}},setup(s){const a=s,e=de();return ue(),(p,o)=>(n(),P(t(Oe),Q(a,{id:t(e).titleId}),{default:f(()=>[N(p.$slots,"default")]),_:3},16,["id"]))}}),Je=as;const ls={name:"Loading",props:{text:{type:String,default:"Loading..."}},components:{LoadingIndicator:gt}},os={class:"flex items-center text-base text-ink-gray-4"};function ns(s,a,e,p,o,d){const g=Pe("LoadingIndicator");return n(),b("div",os,[m(g,{class:"-ml-1 mr-2 h-3 w-3"}),D(" "+w(e.text),1)])}const rs=ne(ls,[["render",ns]]),is={name:"Card",props:{title:{type:String},subtitle:{type:String},loading:{type:Boolean}},components:{LoadingText:rs}},us={class:"flex flex-col rounded-lg border bg-white px-6 py-5 shadow"},ds={class:"flex items-baseline justify-between"},cs={class:"flex items-baseline space-x-2"},ps={key:0,class:"flex items-center space-x-2"},fs={class:"text-xl font-semibold"},ms={key:0,class:"flex items-center space-x-2"},gs={key:0,class:"mt-1.5 text-base text-gray-600"},vs={key:1,class:"mt-4 flex flex-auto flex-col items-center justify-center rounded-md"},ys={key:2,class:"mt-4 flex-auto overflow-auto"};function hs(s,a,e,p,o,d){const g=Pe("LoadingText");return n(),b("div",us,[l("div",ds,[l("div",cs,[s.$slots["actions-left"]?(n(),b("div",ps,[N(s.$slots,"actions-left")])):O("",!0),l("h2",fs,w(e.title),1)]),s.$slots.actions?(n(),b("div",ms,[N(s.$slots,"actions")])):O("",!0)]),e.subtitle?(n(),b("p",gs,w(e.subtitle),1)):O("",!0),e.loading?(n(),b("div",vs,[m(g)])):s.$slots.default?(n(),b("div",ys,[N(s.$slots,"default")])):O("",!0)])}const ge=ne(is,[["render",hs]]),bs=["disabled","id","checked"],_s=["for"],Ne=G({__name:"Checkbox",props:{size:{default:"sm"},label:{},disabled:{type:Boolean},padding:{type:Boolean,default:!1},modelValue:{type:[Boolean,Number]},id:{}},setup(s){var g;const a=s,e=vt(),p=(g=a.id)!=null?g:yt(),o=C(()=>[{sm:"text-base font-medium",md:"text-lg font-medium"}[a.size],a.disabled?"text-ink-gray-4":"text-ink-gray-8","select-none"]),d=C(()=>{let i=a.disabled?"border-outline-gray-2 bg-surface-menu-bar text-ink-gray-3":"border-outline-gray-4 text-ink-gray-9 hover:border-outline-gray-5 focus:ring-offset-0 focus:border-outline-gray-8 active:border-outline-gray-6 transition",u=a.disabled?"":a.padding?"focus:ring-0":"hover:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3 active:bg-surface-gray-2",v={sm:"w-3.5 h-3.5",md:"w-4 h-4"}[a.size];return[i,u,v]});return(i,u)=>(n(),b("div",{class:J(["inline-flex space-x-2 rounded transition",{"px-2.5 py-1.5":s.padding&&s.size==="sm","px-3 py-2":s.padding&&s.size==="md","focus-within:bg-surface-gray-2 focus-within:ring-2 focus-within:ring-outline-gray-3 hover:bg-surface-gray-3 active:bg-surface-gray-4":s.padding&&!s.disabled}])},[l("input",Q({class:["rounded-sm mt-[1px] bg-surface-white",d.value],type:"checkbox",disabled:s.disabled,id:t(p),checked:!!s.modelValue,onChange:u[0]||(u[0]=v=>i.$emit("update:modelValue",v.target.checked))},t(e)),null,16,bs),s.label?(n(),b("label",{key:0,class:J(["block",o.value]),for:t(p)},w(s.label),11,_s)):O("",!0)],2))}}),xs={class:"bg-surface-modal px-4 pb-6 pt-5 sm:px-6"},ks={class:"flex"},ws={class:"w-full flex-1"},Cs={class:"mb-6 flex items-center justify-between"},$s={class:"flex items-center space-x-2"},Ss={class:"text-2xl font-semibold leading-6 text-ink-gray-9"},Is={class:"text-p-base text-ink-gray-7"},Os={key:0,class:"px-4 pb-7 pt-4 sm:px-6"},Ds={class:"space-y-2"},Ps=G({__name:"Dialog",props:{modelValue:{type:Boolean},options:{default:()=>({})},disableOutsideClickToClose:{type:Boolean,default:!1}},emits:["update:modelValue","close","after-leave"],setup(s,{emit:a}){const e=s,p=a,o=C(()=>{let y=e.options.actions;return y!=null&&y.length?y.map(S=>{let k=ht(Ae(R({},S),{loading:!1,onClick:S.onClick?()=>H(this,null,function*(){k.loading=!0;try{if(S.onClick){let F=()=>{console.warn("Value passed to onClick is a context object. Please use context.close() instead of context() to close the dialog."),i()};F.close=i,yield S.onClick(F)}}finally{k.loading=!1}}):i}));return k}):[]}),d=C({get(){return e.modelValue},set(y){p("update:modelValue",y),y||p("close")}});function g(y){d.value=y}function i(){d.value=!1}const u=C(()=>{var S;if(!((S=e.options)!=null&&S.icon))return null;let y=e.options.icon;return typeof y=="string"&&(y={name:y}),y}),v=C(()=>{var k,F;if((k=e.options)!=null&&k.paddingTop)return"";const y=((F=e.options)==null?void 0:F.position)||"center";return{center:"justify-center",top:"pt-[20vh]"}[y]}),x=C(()=>{var y;return(y=e.options)!=null&&y.paddingTop?{paddingTop:e.options.paddingTop}:{}}),_=C(()=>{var k;const y=(k=u.value)==null?void 0:k.appearance;return y?{warning:"bg-surface-amber-2",info:"bg-surface-blue-2",danger:"bg-surface-red-2",success:"bg-surface-green-2"}[y]:"bg-surface-gray-2"}),I=C(()=>{var k;const y=(k=u.value)==null?void 0:k.appearance;return y?{warning:"text-ink-amber-3",info:"text-ink-blue-3",danger:"text-ink-red-4",success:"text-ink-green-3"}[y]:"text-ink-gray-5"});return(y,S)=>(n(),P(t(Nt),{open:d.value,"onUpdate:open":[S[3]||(S[3]=k=>d.value=k),g]},{default:f(()=>[m(t(ss),null,{default:f(()=>[m(t(es),{class:"fixed inset-0 bg-black-overlay-200 backdrop-filter backdrop-blur-[12px] overflow-y-auto dialog-overlay outline-none","data-dialog":s.options.title,onAfterLeave:S[2]||(S[2]=k=>y.$emit("after-leave"))},{default:f(()=>[l("div",{class:J(["flex min-h-screen flex-col items-center px-4 py-4 text-center",v.value]),style:Re(x.value)},[m(t(Qt),{class:J(["my-8 inline-block w-full transform overflow-hidden rounded-xl bg-surface-modal text-left align-middle shadow-xl dialog-content focus-visible:outline-none",{"max-w-7xl":s.options.size==="7xl","max-w-6xl":s.options.size==="6xl","max-w-5xl":s.options.size==="5xl","max-w-4xl":s.options.size==="4xl","max-w-3xl":s.options.size==="3xl","max-w-2xl":s.options.size==="2xl","max-w-xl":s.options.size==="xl","max-w-lg":s.options.size==="lg"||!s.options.size,"max-w-md":s.options.size==="md","max-w-sm":s.options.size==="sm","max-w-xs":s.options.size==="xs"}]),onEscapeKeyDown:S[0]||(S[0]=k=>i()),onInteractOutside:S[1]||(S[1]=k=>{e.disableOutsideClickToClose&&k.preventDefault()})},{default:f(()=>[N(y.$slots,"body",{},()=>[N(y.$slots,"body-main",{},()=>[l("div",xs,[l("div",ks,[l("div",ws,[N(y.$slots,"body-header",{},()=>[l("div",Cs,[l("div",$s,[u.value?(n(),b("div",{key:0,class:J(["flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full",_.value])},[m(A,{name:u.value.name,class:J(["h-4 w-4",I.value]),"aria-hidden":"true"},null,8,["name","class"])],2)):O("",!0),m(t(Je),{as:"header"},{default:f(()=>[N(y.$slots,"body-title",{},()=>[l("h3",Ss,w(s.options.title||"Untitled"),1)],!0)]),_:3})]),m(t(Lt),{"as-child":""},{default:f(()=>[m(t(M),{variant:"ghost",onClick:i},{icon:f(()=>[m(t(Le),{class:"h-4 w-4 text-ink-gray-9"})]),_:1})]),_:1})])],!0),N(y.$slots,"body-content",{},()=>[s.options.message?(n(),P(t(He),{key:0,"as-child":""},{default:f(()=>[l("p",Is,w(s.options.message),1)]),_:1})):O("",!0)],!0)])])])],!0),o.value.length||y.$slots.actions?(n(),b("div",Os,[N(y.$slots,"actions",Be(Fe({close:i})),()=>[l("div",Ds,[(n(!0),b(te,null,ie(o.value,k=>(n(),P(t(M),Q({class:"w-full",key:k.label,disabled:k.disabled},{ref_for:!0},k),{default:f(()=>[D(w(k.label),1)]),_:2},1040,["disabled"]))),128))])],!0)])):O("",!0)],!0)]),_:3},8,["class"])],6)]),_:3},8,["data-dialog"])]),_:3})]),_:3},8,["open"]))}}),zs=ne(Ps,[["__scopeId","data-v-5e9d9e2d"]]),Se=zs;Se.Title=Je;Se.Description=He;class Es{constructor(){this.listeners={},this.failed=!1}on(a,e){this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(e)}trigger(a,e){(this.listeners[a]||[]).forEach(o=>{o.call(this,e)})}upload(a,e){return new Promise((p,o)=>{let d=new XMLHttpRequest;d.upload.addEventListener("loadstart",()=>{this.trigger("start")}),d.upload.addEventListener("progress",u=>{u.lengthComputable&&this.trigger("progress",{uploaded:u.loaded,total:u.total})}),d.upload.addEventListener("load",()=>{this.trigger("finish")}),d.addEventListener("error",()=>{this.trigger("error"),o()}),d.onreadystatechange=()=>{if(d.readyState==XMLHttpRequest.DONE){let u;if(d.status===200){let v=null;try{v=JSON.parse(d.responseText)}catch(_){v=d.responseText}let x=v.message||v;p(x)}else if(d.status===403)u=JSON.parse(d.responseText);else{this.failed=!0;try{u=JSON.parse(d.responseText)}catch(v){}}u&&u.exc&&console.error(JSON.parse(u.exc)[0]),o(u)}};const g=e.upload_endpoint||"/api/method/upload_file";d.open("POST",g,!0),d.setRequestHeader("Accept","application/json"),window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&d.setRequestHeader("X-Frappe-CSRF-Token",window.csrf_token);let i=new FormData;a&&i.append("file",a,a.name),i.append("is_private",e.private?"1":"0"),i.append("folder",e.folder||"Home"),e.file_url&&i.append("file_url",e.file_url),e.doctype&&i.append("doctype",e.doctype),e.docname&&i.append("docname",e.docname),e.fieldname&&i.append("fieldname",e.fieldname),e.method&&i.append("method",e.method),e.type&&i.append("type",e.type),e.optimize&&(i.append("optimize","1"),e.max_width&&i.append("max_width",e.max_width.toString()),e.max_height&&i.append("max_height",e.max_height.toString())),d.send(i)})}}const Bs={name:"FileUploader",props:{fileTypes:{type:[String,Array]},uploadArgs:{type:Object},validateFile:{type:Function,default:null}},data(){return{uploader:null,uploading:!1,uploaded:0,error:null,message:"",total:0,file:null,finishedUploading:!1}},computed:{progress(){let s=Math.floor(this.uploaded/this.total*100);return isNaN(s)?0:s},success(){return this.finishedUploading&&!this.error}},methods:{inputRef(){return this.$refs.input},openFileSelector(){this.$refs.input.click()},onFileAdd(s){return H(this,null,function*(){if(this.error=null,this.file=s.target.files[0],this.file&&this.validateFile)try{let a=yield this.validateFile(this.file);a&&(this.error=a)}catch(a){this.error=a}this.error||this.uploadFile(this.file)})},uploadFile(s){return H(this,null,function*(){this.error=null,this.uploaded=0,this.total=0,this.uploader=new Es,this.uploader.on("start",()=>{this.uploading=!0}),this.uploader.on("progress",a=>{this.uploaded=a.uploaded,this.total=a.total}),this.uploader.on("error",()=>{this.uploading=!1,this.error="Error Uploading File"}),this.uploader.on("finish",()=>{this.uploading=!1,this.finishedUploading=!0}),this.uploader.upload(s,this.uploadArgs||{}).then(a=>{this.$emit("success",a)}).catch(a=>{this.uploading=!1;let e="Error Uploading File";a!=null&&a._server_messages?e=JSON.parse(JSON.parse(a._server_messages)[0]).message:a!=null&&a.exc&&(e=JSON.parse(a.exc)[0].split(`
`).slice(-2,-1)[0]),this.error=e,this.$emit("failure",a)})})}},expose:["inputRef"]},Fs=["accept"];function Ts(s,a,e,p,o,d){const g=Pe("Button");return n(),b("div",null,[l("input",{ref:"input",type:"file",accept:e.fileTypes,class:"hidden",onChange:a[0]||(a[0]=(...i)=>d.onFileAdd&&d.onFileAdd(...i))},null,40,Fs),N(s.$slots,"default",Be(Fe({file:o.file,uploading:o.uploading,progress:d.progress,uploaded:o.uploaded,message:o.message,error:o.error,total:o.total,success:d.success,openFileSelector:d.openFileSelector})),()=>[m(g,{onClick:d.openFileSelector,loading:o.uploading},{default:f(()=>[D(w(o.uploading?`Uploading ${d.progress}%`:"Upload File"),1)]),_:1},8,["onClick","loading"])])])}const Vs=ne(Bs,[["render",Ts]]),As={name:"Input",inheritAttrs:!1,expose:["getInputValue"],components:{FeatherIcon:A},props:{label:{type:String},type:{type:String,default:"text",validator(s){let a=["text","number","checkbox","textarea","select","email","password","date"].includes(s);return a||console.warn(`Invalid value "${s}" for "type" prop for Input`),a}},modelValue:{type:[String,Number,Boolean,Object,Array]},inputClass:{type:[String,Array,Object]},debounce:{type:Number},options:{type:Array},disabled:{type:Boolean},rows:{type:Number,default:3},placeholder:{type:String},iconLeft:{type:String}},emits:["input","change","update:modelValue"],methods:{focus(){this.$refs.input.focus()},blur(){this.$refs.input.blur()},getInputValue(s){let a=s?s.target:this.$refs.input,e=a.value;return this.type=="checkbox"&&(e=a.checked),e}},computed:{passedInputValue(){return"value"in this.$attrs?this.$attrs.value:this.modelValue||null},inputAttributes(){let s={},a=e=>{this.$emit("input",this.getInputValue(e))};return this.debounce&&(a=bt(a,this.debounce)),this.type=="checkbox"&&(s.checked=this.passedInputValue),Object.assign(s,this.$attrs,{onInput:a,onChange:e=>{this.$emit("change",this.getInputValue(e)),this.$emit("update:modelValue",this.getInputValue(e))}})},selectOptions(){return this.options.map(s=>typeof s=="string"?{label:s,value:s}:s).filter(Boolean)},isNormalInput(){return["text","number","checkbox","email","password","date"].includes(this.type)}}},qs={key:0,class:"mb-2 block text-sm leading-4 text-gray-700"},Ms=["type","disabled","placeholder","value"],Ns=["placeholder","value","disabled","rows"],Us=["disabled"],Ls=["value","disabled","selected"],js={key:1,class:"ml-2 inline-block text-base leading-4"};function Rs(s,a,e,p,o,d){const g=Pe("FeatherIcon");return n(),b("label",{class:J([e.type=="checkbox"?"flex":"block",s.$attrs.class]),style:Re(s.$attrs.style)},[e.label&&e.type!="checkbox"?(n(),b("span",qs,w(e.label),1)):O("",!0),l("div",{class:J(["relative flex",{"items-center":d.isNormalInput||e.type=="select"}])},[e.iconLeft&&e.type!="checkbox"?(n(),P(g,{key:0,name:e.iconLeft,class:J(["absolute mx-2 h-4 w-4 text-gray-600",{"mt-2":e.type=="textarea"}])},null,8,["name","class"])):O("",!0),d.isNormalInput?(n(),b("input",Q({key:1},d.inputAttributes,{class:["border-gray-400 placeholder-gray-500",[{"form-input block w-full":e.type!="checkbox","form-checkbox":e.type=="checkbox","pl-8":e.iconLeft&&e.type!="checkbox"},e.inputClass]],ref:"input",type:e.type||"text",disabled:e.disabled,placeholder:e.placeholder,value:d.passedInputValue}),null,16,Ms)):O("",!0),e.type==="textarea"?(n(),b("textarea",Q({key:2},d.inputAttributes,{placeholder:e.placeholder,class:["placeholder-gray-500",["form-textarea block w-full resize-none",e.inputClass,{"pl-8":e.iconLeft}]],ref:"input",value:d.passedInputValue,disabled:e.disabled,rows:e.rows}),null,16,Ns)):O("",!0),e.type==="select"?(n(),b("select",Q({key:3},d.inputAttributes,{class:["form-select block w-full",{"pl-8":e.iconLeft}],ref:"input",disabled:e.disabled}),[(n(!0),b(te,null,ie(d.selectOptions,i=>(n(),b("option",{key:i.value,value:i.value,disabled:i.disabled||!1,selected:d.passedInputValue===i.value},w(i.label),9,Ls))),128))],16,Us)):O("",!0)],2),e.label&&e.type=="checkbox"?(n(),b("span",js,w(e.label),1)):O("",!0)],6)}const Xe=ne(As,[["render",Rs]]),Ks={},Hs={class:"spinner",viewBox:"0 0 50 50"};function Js(s,a){return n(),b("svg",Hs,[...a[0]||(a[0]=[l("defs",null,[l("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[l("stop",{offset:"0%","stop-color":"rgba(0,110,219,1)"}),l("stop",{offset:"100%","stop-color":"rgba(255,255,255,0)"})])],-1),l("circle",{stroke:"url(#gradient)",class:"spinner-path",cx:"25",cy:"25",r:"20",fill:"none","stroke-width":"5"},null,-1)])])}const Xs=ne(Ks,[["render",Js],["__scopeId","data-v-5c03f65e"]]);function Qs(s,a){let e=null;return function(...p){e&&clearTimeout(e),e=setTimeout(()=>{s.apply(this,p)},a)}}function Gs(s){if(!s)return"";const a=new Date(s);return isNaN(a.getTime())?"":a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}const Ue="store_detail_column_settings";function Ws(s,a){const e=B({search:"",category:""}),p=B({currentPage:1,pageSize:50,pageSizeOptions:[20,50,100,200]}),o=B({hiddenColumns:[]}),d=B(!1),g=B(null),i=B(null),u=B(new Set),v=B(new Set),x=_t({url:"product_sales_planning.api.v1.commodity.get_store_commodity_data",params:()=>({store_id:s,task_id:a,view_mode:"multi",start:(p.value.currentPage-1)*p.value.pageSize,page_length:p.value.pageSize,search_term:e.value.search||null,category:e.value.category||null}),auto:!0,transform:c=>({commodities:c.data||[],months:c.months||[],store_info:c.store_info||{},task_info:c.task_info||{},can_edit:c.can_edit!==void 0?c.can_edit:!0,total_count:c.total_count||0})}),_=C(()=>{var c;return((c=x.data)==null?void 0:c.store_info)||{}}),I=C(()=>{var c;return((c=x.data)==null?void 0:c.task_info)||{}}),y=C(()=>{var c;return((c=x.data)==null?void 0:c.can_edit)||!1}),S=C(()=>{var c;return((c=x.data)==null?void 0:c.total_count)||0}),k=C(()=>Math.ceil(S.value/p.value.pageSize)||1),F=C(()=>{var c;return((c=x.data)==null?void 0:c.months)||[]}),U=C(()=>{var c;return((c=x.data)==null?void 0:c.commodities)||[]}),V=C(()=>U.value),ae=C(()=>{const c=U.value;let E=0;c.forEach(q=>{q.months&&Object.values(q.months).forEach(K=>{E+=Number((K==null?void 0:K.quantity)||0)})});const X=c.filter(q=>q.months?Object.values(q.months).some(K=>((K==null?void 0:K.quantity)||0)>0):!1).length;return{totalSKU:c.length,totalQuantity:E,plannedSKU:X}}),ye=C(()=>{const c=U.value,E=new Set;return c.forEach(X=>{X.category&&E.add(X.category)}),{categories:Array.from(E).sort()}}),Y=C(()=>v.value.size),W=C(()=>v.value.size>0),ke=()=>{const c=[{data:"__selected",title:"",type:"checkbox",width:50,className:"htCenter htMiddle"},{data:"name1",title:"商品名称",readOnly:!0,width:250,className:"htLeft htMiddle"},{data:"code",title:"编码",readOnly:!0,width:120},{data:"specifications",title:"规格",readOnly:!0,width:100},{data:"brand",title:"品牌",readOnly:!0,width:100},{data:"category",title:"类别",readOnly:!0,width:100}];return F.value.forEach(E=>{c.push({data:E,title:E,type:"numeric",readOnly:!y.value,width:100,numericFormat:{pattern:"0,0"}})}),c},le=()=>{const c=["选择","商品名称","编码","规格","品牌","类别"];return F.value.forEach(E=>{c.push(E)}),c},ce=()=>U.value.map((c,E)=>{const X={__selected:u.value.has(E),name1:c.commodity_name||c.name1,code:c.commodity_code||c.code,specifications:c.specifications||"",brand:c.brand||"",category:c.category||""};return F.value.forEach(q=>{var xe,T;const K=(xe=c.months)==null?void 0:xe[q];X[q]=(T=K==null?void 0:K.quantity)!=null?T:0}),X}),we=()=>{try{const c=localStorage.getItem(Ue);if(c){const E=JSON.parse(c);o.value={hiddenColumns:E.hiddenColumns||[]}}}catch(c){console.error("加载列设置失败:",c)}},re=Qs(()=>{try{localStorage.setItem(Ue,JSON.stringify(o.value))}catch(c){console.error("保存列设置失败:",c)}},500),he=c=>{const E=o.value.hiddenColumns.indexOf(c);E>-1?o.value.hiddenColumns.splice(E,1):o.value.hiddenColumns.push(c),re()},Z=()=>{o.value.hiddenColumns=[],re()},be=c=>o.value.hiddenColumns.includes(c),me=()=>H(this,null,function*(){yield x.reload()}),pe=c=>{e.value=R(R({},e.value),c),p.value.currentPage=1,r(),x.reload()},Ce=c=>{p.value=R(R({},p.value),c),r(),x.reload()},oe=c=>H(this,null,function*(){d.value=!0,g.value=null;try{const X=c.map(([K,xe,T,$])=>{const L=U.value[K],$e=xe-6;return!L||$e<0||$e>=F.value.length?null:{code:L.commodity_code||L.code,month:F.value[$e],quantity:$}}).filter(Boolean),q=yield ve("product_sales_planning.api.v1.commodity.batch_update_month_quantities",{store_id:s,task_id:a,updates:JSON.stringify(X)});return(q==null?void 0:q.status)==="success"?(i.value=new Date,{success:!0,message:"保存成功"}):(g.value=(q==null?void 0:q.message)||"保存失败",{success:!1,message:(q==null?void 0:q.message)||"保存失败"})}catch(E){return console.error("保存失败:",E),g.value=E.message||"保存失败",{success:!1,message:E.message||"保存失败"}}finally{d.value=!1}}),fe=()=>H(this,null,function*(){try{const c=yield ve("product_sales_planning.api.v1.import_export.export_commodity_data",{store_id:s,task_id:a});return(c==null?void 0:c.status)==="success"?(window.open(c.file_url,"_blank"),{success:!0,message:`成功导出 ${c.record_count} 条记录`}):{success:!1,message:(c==null?void 0:c.message)||"导出失败"}}catch(c){return{success:!1,message:c.message||"导出失败"}}}),h=c=>{u.value=new Set(c);const E=new Set;c.forEach(X=>{const q=U.value[X];if(q){const K=q.commodity_code||q.code;K&&E.add(K)}}),v.value=E},r=()=>{u.value=new Set,v.value=new Set},z=()=>H(this,null,function*(){if(v.value.size===0)return{success:!1,message:"请先选择要删除的商品"};try{const c=Array.from(v.value),E=yield ve("product_sales_planning.api.v1.commodity.batch_delete_by_codes",{store_id:s,task_id:a,codes:JSON.stringify(c)});return(E==null?void 0:E.status)==="success"?(r(),yield me(),{success:!0,message:E.message||`成功删除 ${E.count} 条记录`}):{success:!1,message:(E==null?void 0:E.message)||"删除失败"}}catch(c){return{success:!1,message:c.message||"删除失败"}}}),_e=()=>{try{r(),x&&typeof x.cancel=="function"&&x.cancel(),re.cancel&&re.cancel()}catch(c){console.error("清理资源失败:",c)}};return De(()=>{we()}),xt(()=>{_e()}),se(o,()=>{re()},{deep:!0}),{filters:e,pagination:p,columnSettings:o,selectedRows:u,selectedCodes:v,isSaving:d,saveError:g,lastSaveTime:i,storeInfo:_,taskInfo:I,canEdit:y,statistics:ae,totalCount:S,totalPages:k,months:F,rawCommodities:U,filteredCommodities:V,filterOptions:ye,selectedCount:Y,hasSelection:W,loading:C(()=>x.loading),error:C(()=>x.error),generateColumns:ke,generateHeaders:le,transformDataForTable:ce,toggleColumn:he,resetColumnSettings:Z,isColumnHidden:be,refreshData:me,updateFilters:pe,updatePagination:Ce,batchSaveChanges:oe,exportToExcel:fe,updateSelectedRows:h,clearSelection:r,batchDeleteSelected:z,cleanup:_e}}const Ys={class:"flex flex-wrap gap-4 items-end"},Zs={class:"flex-1 min-w-[240px]"},ea={class:"w-56"},ta={class:"flex items-center gap-2"},sa={key:0,class:"mt-3 flex flex-wrap gap-2"},aa={__name:"FilterPanel",props:{filters:{type:Object,default:()=>({search:"",category:""})},filterOptions:{type:Object,default:()=>({mechanisms:[],categories:[]})},loading:{type:Boolean,default:!1}},emits:["update:filters"],setup(s,{emit:a}){const e=s,p=a,o=B(R({},e.filters)),d=C(()=>{var x;const v=((x=e.filterOptions)==null?void 0:x.categories)||[];return[{label:"全部",value:""},...v.map(_=>({label:_,value:_}))]}),g=C(()=>{let v=0;return o.value.search&&(v+=1),o.value.category&&(v+=1),v});se(()=>e.filters,v=>{o.value=R({},v)},{deep:!0});const i=()=>{p("update:filters",R({},o.value))},u=()=>{o.value={search:"",category:""},i()};return(v,x)=>(n(),P(t(ge),{class:"p-4"},{default:f(()=>[l("div",Ys,[l("div",Zs,[m(t(Xe),{modelValue:o.value.search,"onUpdate:modelValue":[x[0]||(x[0]=_=>o.value.search=_),i],label:"搜索商品",disabled:s.loading,placeholder:"输入商品编码或名称..."},{prefix:f(()=>[m(t(A),{name:"search",class:"w-4 h-4 text-gray-400"})]),_:1},8,["modelValue","disabled"])]),l("div",ea,[m(t(Ie),{modelValue:o.value.category,"onUpdate:modelValue":[x[1]||(x[1]=_=>o.value.category=_),i],label:"分类",options:d.value,disabled:s.loading,placeholder:"全部"},null,8,["modelValue","options","disabled"])]),l("div",ta,[m(t(M),{variant:"subtle",theme:"gray","icon-left":"rotate-ccw",loading:s.loading,onClick:u},{default:f(()=>[...x[2]||(x[2]=[D(" 重置 ",-1)])]),_:1},8,["loading"]),g.value>0?(n(),P(t(ee),{key:0,theme:"blue",size:"sm"},{default:f(()=>[D(" 已应用 "+w(g.value)+" 项筛选 ",1)]),_:1})):O("",!0)])]),g.value>0?(n(),b("div",sa,[o.value.search?(n(),P(t(ee),{key:0,theme:"gray",size:"sm"},{default:f(()=>[D(" 搜索: "+w(o.value.search),1)]),_:1})):O("",!0),o.value.category?(n(),P(t(ee),{key:1,theme:"gray",size:"sm"},{default:f(()=>[D(" 分类: "+w(o.value.category),1)]),_:1})):O("",!0)])):O("",!0)]),_:1}))}},la={class:"stats-cards grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},oa={class:"flex items-center justify-between"},na={class:"text-sm text-gray-500 mb-1"},ra={__name:"StatsCards",props:{statistics:{type:Object,default:()=>({totalSKU:0,plannedSKU:0,totalQuantity:0})}},setup(s){const a=s,e=o=>o?o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0",p=C(()=>[{label:"总 SKU 数",value:e(a.statistics.totalSKU),icon:"grid",color:"text-gray-900",iconColor:"text-blue-600",bg:"bg-blue-50"},{label:"已规划 SKU",value:e(a.statistics.plannedSKU),icon:"check-circle",color:"text-green-600",iconColor:"text-green-600",bg:"bg-green-50"},{label:"总计划量",value:e(a.statistics.totalQuantity),icon:"trending-up",color:"text-purple-600",iconColor:"text-purple-600",bg:"bg-purple-50"}]);return(o,d)=>(n(),b("div",la,[(n(!0),b(te,null,ie(p.value,g=>(n(),P(t(ge),{class:"p-4",key:g.label},{default:f(()=>[l("div",oa,[l("div",null,[l("div",na,w(g.label),1),l("div",{class:J(["text-2xl font-bold",g.color])},w(g.value),3)]),l("div",{class:J(["w-12 h-12 rounded-full flex items-center justify-center",g.bg])},[m(t(A),{name:g.icon,class:J(["w-6 h-6",g.iconColor])},null,8,["name","class"])],2)])]),_:2},1024))),128))]))}},ia={class:"flex items-center gap-2"},ua={class:"text-sm text-gray-600"},da={class:"flex items-center gap-2"},ca={class:"flex items-center gap-1"},pa={key:1,class:"px-2 text-gray-500"},fa={__name:"PaginationControls",props:{currentPage:{type:Number,default:1},pageSize:{type:Number,default:50},totalItems:{type:Number,default:0},totalPages:{type:Number,default:1},pageSizeOptions:{type:Array,default:()=>[20,50,100,200]}},emits:["update:currentPage","update:pageSize"],setup(s,{emit:a}){const e=s,p=a,o=B(e.pageSize),d=C(()=>e.totalItems===0?0:(e.currentPage-1)*e.pageSize+1),g=C(()=>{const _=e.currentPage*e.pageSize;return e.totalItems===0?0:_>e.totalItems?e.totalItems:_}),i=C(()=>(e.pageSizeOptions||[]).map(_=>({label:`${_}`,value:_}))),u=C(()=>{const _=[],I=e.totalPages,y=e.currentPage;if(I<=7)for(let S=1;S<=I;S++)_.push(S);else if(y<=4){for(let S=1;S<=5;S++)_.push(S);_.push("..."),_.push(I)}else if(y>=I-3){_.push(1),_.push("...");for(let S=I-4;S<=I;S++)_.push(S)}else{_.push(1),_.push("...");for(let S=y-1;S<=y+1;S++)_.push(S);_.push("..."),_.push(I)}return _}),v=_=>{_>=1&&_<=e.totalPages&&_!==e.currentPage&&p("update:currentPage",_)},x=()=>{p("update:pageSize",o.value),p("update:currentPage",1)};return se(()=>e.pageSize,_=>{o.value=_}),(_,I)=>(n(),P(t(ge),{class:"p-4 flex flex-wrap items-center justify-between gap-3"},{default:f(()=>[l("div",ia,[I[5]||(I[5]=l("span",{class:"text-sm text-gray-600"},"每页显示",-1)),m(t(Ie),{modelValue:o.value,"onUpdate:modelValue":[I[0]||(I[0]=y=>o.value=y),x],options:i.value,size:"sm"},null,8,["modelValue","options"]),I[6]||(I[6]=l("span",{class:"text-sm text-gray-600"},"条",-1))]),l("div",ua," 显示 "+w(d.value)+" - "+w(g.value)+" 条，共 "+w(s.totalItems)+" 条 ",1),l("div",da,[m(t(M),{variant:"ghost",theme:"gray","icon-left":"chevrons-left",disabled:s.currentPage===1,onClick:I[1]||(I[1]=y=>v(1))},null,8,["disabled"]),m(t(M),{variant:"ghost",theme:"gray","icon-left":"chevron-left",disabled:s.currentPage===1,onClick:I[2]||(I[2]=y=>v(s.currentPage-1))},null,8,["disabled"]),l("div",ca,[(n(!0),b(te,null,ie(u.value,y=>(n(),b(te,{key:y},[y!=="..."?(n(),P(t(M),{key:0,onClick:S=>v(y),size:"sm",theme:y===s.currentPage?"blue":"gray",variant:y===s.currentPage?"solid":"ghost"},{default:f(()=>[D(w(y),1)]),_:2},1032,["onClick","theme","variant"])):(n(),b("span",pa,"..."))],64))),128))]),m(t(M),{variant:"ghost",theme:"gray","icon-left":"chevron-right",disabled:s.currentPage===s.totalPages,onClick:I[3]||(I[3]=y=>v(s.currentPage+1))},null,8,["disabled"]),m(t(M),{variant:"ghost",theme:"gray","icon-left":"chevrons-right",disabled:s.currentPage===s.totalPages,onClick:I[4]||(I[4]=y=>v(s.totalPages))},null,8,["disabled"])])]),_:1}))}},ma={class:"space-y-4"},ga={class:"flex items-center justify-between"},va={class:"border border-gray-100 rounded-lg p-4 bg-gray-50"},ya={class:"flex items-center justify-between mb-2"},ha={key:0,class:"mt-2 text-sm text-gray-600"},ba={key:1,class:"mt-2 text-sm text-red-600"},_a={key:0,class:"mt-2"},xa={key:0,class:"mt-2 bg-red-50 border border-red-100 rounded p-3"},ka={class:"text-sm text-red-700 space-y-1 max-h-40 overflow-y-auto"},wa={__name:"ProductImportDialog",props:{show:{type:Boolean,default:!1},storeId:{type:String,required:!0},taskId:{type:String,required:!0}},emits:["close","success"],setup(s,{emit:a}){const e=s,p=a,o=B(!1),d=B(!1),g=B(null),i=B(null),u=B(null),v=C({get:()=>e.show,set:k=>{k||S()}}),x=()=>H(this,null,function*(){d.value=!0;try{const k=yield ve("product_sales_planning.api.v1.import_export.download_import_template");k&&k.status==="success"?window.open(k.file_url,"_blank"):j.error((k==null?void 0:k.msg)||"模板生成失败")}catch(k){j.error(k.message||"模板生成失败")}finally{d.value=!1}}),_=k=>{i.value=null,g.value=(k==null?void 0:k.message)||k,u.value=null},I=k=>{i.value=(k==null?void 0:k.message)||"文件上传失败",g.value=null},y=()=>H(this,null,function*(){var F,U;const k=((F=g.value)==null?void 0:F.file_url)||((U=g.value)==null?void 0:U.url);if(!k){j.error("请先上传 Excel 文件");return}o.value=!0,u.value=null;try{const V=yield ve("product_sales_planning.api.v1.import_export.import_commodity_data",{store_id:e.storeId,task_id:e.taskId,file_url:k});V&&V.status==="success"?(u.value={success:!0,message:V.msg||"导入成功",errors:V.errors||[]},j.success(u.value.message),p("success"),S()):(u.value={success:!1,message:(V==null?void 0:V.msg)||"导入失败",errors:(V==null?void 0:V.errors)||[]},j.error(u.value.message))}catch(V){u.value={success:!1,message:V.message||"导入失败",errors:[]},j.error(u.value.message)}finally{o.value=!1}}),S=()=>{o.value||(g.value=null,i.value=null,u.value=null,p("close"))};return(k,F)=>(n(),P(t(Se),{modelValue:v.value,"onUpdate:modelValue":F[0]||(F[0]=U=>v.value=U),title:"单品导入"},{"body-content":f(()=>[l("div",ma,[m(t(ze),{theme:"blue",title:"Excel 格式要求",description:"第一行：产品编码 | 产品名称 | 月份列；月份格式支持 2025-01、202501、2025/01；空值或 0 将被跳过。"}),l("div",ga,[m(t(M),{variant:"outline",theme:"blue","icon-left":"download",loading:d.value,onClick:x},{default:f(()=>[...F[1]||(F[1]=[D(" 下载导入模板 ",-1)])]),_:1},8,["loading"])]),l("div",va,[l("div",ya,[F[3]||(F[3]=l("div",{class:"text-sm font-medium text-gray-800"},"选择 Excel 文件",-1)),g.value?(n(),P(t(ee),{key:0,theme:"green",size:"sm"},{default:f(()=>[...F[2]||(F[2]=[D("已上传",-1)])]),_:1})):O("",!0)]),m(t(Vs),{"file-types":".xlsx,.xls","upload-args":{private:!0,folder:"Home"},onSuccess:_,onFailure:I},{default:f(({openFileSelector:U,uploading:V,progress:ae})=>[m(t(M),{variant:"solid",theme:"blue","icon-left":"upload",loading:V,onClick:()=>{i.value=null,U()}},{default:f(()=>[D(w(V?`上传中 ${ae}%`:"选择文件"),1)]),_:2},1032,["loading","onClick"])]),_:1}),g.value?(n(),b("p",ha," 已选择："+w(g.value.file_name||g.value.name||"已上传文件"),1)):O("",!0),i.value?(n(),b("p",ba,w(i.value),1)):O("",!0)]),u.value?(n(),b("div",_a,[m(t(ze),{theme:u.value.success?"green":"red",title:u.value.success?"导入成功":"导入失败",description:u.value.message},null,8,["theme","title","description"]),u.value.errors&&u.value.errors.length?(n(),b("div",xa,[F[4]||(F[4]=l("p",{class:"text-sm font-medium text-red-800 mb-1"},"错误详情：",-1)),l("ul",ka,[(n(!0),b(te,null,ie(u.value.errors,(U,V)=>(n(),b("li",{key:V}," • "+w(U),1))),128))])])):O("",!0)])):O("",!0)])]),actions:f(()=>[m(t(M),{variant:"subtle",theme:"gray",onClick:S},{default:f(()=>[...F[5]||(F[5]=[D(" 取消 ",-1)])]),_:1}),m(t(M),{variant:"solid",theme:"blue","icon-left":"play",loading:o.value,disabled:!g.value,onClick:y},{default:f(()=>[...F[6]||(F[6]=[D(" 开始导入 ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"]))}},Ca=ne(wa,[["__scopeId","data-v-463b2196"]]),$a={class:"product-add-dialog"},Sa={class:"search-filter-section"},Ia={class:"section-header"},Oa={class:"filter-grid"},Da={class:"filter-item"},Pa={class:"filter-item"},za={class:"filter-item"},Ea={class:"filter-summary"},Ba={class:"flex items-center gap-2 text-sm text-gray-600"},Fa={class:"text-gray-900"},Ta={class:"product-list-section"},Va={class:"section-header"},Aa={key:0,class:"loading-state"},qa={key:1,class:"empty-state"},Ma={key:2,class:"product-list"},Na={class:"select-all-item"},Ua={class:"text-gray-500 text-sm ml-2"},La={class:"product-items"},ja=["onClick"],Ra={class:"product-checkbox"},Ka={class:"product-info"},Ha={class:"product-header"},Ja={class:"product-code-name"},Xa={class:"product-code"},Qa={class:"product-name"},Ga={class:"product-details"},Wa={key:0,class:"product-detail-item"},Ya={key:1,class:"product-detail-item"},Za={key:2,class:"product-detail-item"},el={key:0,class:"pagination-section"},tl={class:"pagination-info"},sl={class:"pagination-controls"},al={class:"pagination-pages"},ll={class:"current-page"},ol={class:"total-pages"},nl={class:"dialog-actions"},rl={key:0},il={key:1},ul={__name:"ProductAddDialog",props:{show:{type:Boolean,default:!1},storeId:{type:String,required:!0},taskId:{type:String,required:!0},existingProducts:{type:Array,default:()=>[]}},emits:["close","success"],setup(s,{emit:a}){const e=s,p=a,o=B(!1),d=B(!1),g=B([]),i=B(new Set),u=B(""),v=B(""),x=B(""),_=B(""),I=B(1),y=B(20),S=B(null),k=C({get:()=>e.show,set:h=>{h||oe()}}),F=C(()=>{const h=new Set;return g.value.forEach(r=>{r.brand&&h.add(r.brand)}),Array.from(h).sort()}),U=C(()=>{const h=new Set;return g.value.forEach(r=>{r.category&&h.add(r.category)}),Array.from(h).sort()}),V=C(()=>[{label:"全部品牌",value:""},...F.value.map(h=>({label:h,value:h}))]),ae=C(()=>[{label:"全部分类",value:""},...U.value.map(h=>({label:h,value:h}))]),ye=C(()=>new Set(e.existingProducts.map(h=>h.code||h.commodity_code))),Y=h=>ye.value.has(h.code),W=C(()=>{let h=g.value;if(v.value){const r=v.value.toLowerCase();h=h.filter(z=>(z.code||"").toLowerCase().includes(r)||(z.name1||"").toLowerCase().includes(r))}return x.value&&(h=h.filter(r=>r.brand===x.value)),_.value&&(h=h.filter(r=>r.category===_.value)),h}),ke=C(()=>W.value.length),le=C(()=>{const h=(I.value-1)*y.value,r=h+y.value;return W.value.slice(h,r)}),ce=C(()=>Math.ceil(W.value.length/y.value)||1),we=C(()=>(I.value-1)*y.value+1),re=C(()=>{const h=I.value*y.value;return h>W.value.length?W.value.length:h}),he=C(()=>le.value.length>0&&le.value.every(h=>i.value.has(h.code)||Y(h))),Z=()=>H(this,null,function*(){o.value=!0;try{const h=yield ve("frappe.client.get_list",{doctype:"Product List",fields:["name as code","name1","specifications","brand","category"],limit_page_length:500,or_filters:u.value?[["code","like",`%${u.value}%`],["name1","like",`%${u.value}%`]]:[],order_by:"name1 asc"});g.value=Array.isArray(h)?h:[]}catch(h){j.error(h.message||"加载产品失败")}finally{o.value=!1}}),be=h=>{const r=new Set(i.value);r.has(h)?r.delete(h):r.add(h),i.value=r},me=()=>{const h=new Set(i.value);he.value?le.value.forEach(r=>{Y(r)||h.delete(r.code)}):le.value.forEach(r=>{Y(r)||h.add(r.code)}),i.value=h},pe=h=>{h<1||h>ce.value||(I.value=h)},Ce=()=>H(this,null,function*(){if(i.value.size===0){j.warning("请选择要添加的商品");return}d.value=!0;try{const h=Array.from(i.value),r=yield ve("product_sales_planning.api.v1.commodity.bulk_insert_commodity_schedule",{store_id:e.storeId,task_id:e.taskId,codes:JSON.stringify(h)});if(r&&r.status==="success"){const z=r.skipped>0?`，跳过 ${r.skipped} 个已存在的商品`:"";j.success(`成功添加 ${r.count} 个商品${z}`),p("success"),oe()}else j.error((r==null?void 0:r.msg)||(r==null?void 0:r.message)||"添加失败")}catch(h){j.error(h.message||"添加失败")}finally{d.value=!1}}),oe=()=>{d.value||(i.value=new Set,u.value="",x.value="",_.value="",I.value=1,p("close"))},fe=h=>{u.value=h};return se(u,h=>{S.value&&clearTimeout(S.value),S.value=setTimeout(()=>{v.value=h,I.value=1},300)}),se([x,_],()=>{I.value=1}),se(v,()=>{I.value=1}),se(()=>e.show,h=>{h&&Z()}),De(()=>{e.show&&Z()}),(h,r)=>(n(),P(t(Se),{modelValue:k.value,"onUpdate:modelValue":r[5]||(r[5]=z=>k.value=z),options:{title:"添加商品",size:"4xl"}},{"body-content":f(()=>[l("div",$a,[l("div",Sa,[l("div",Ia,[m(t(A),{name:"search",class:"w-4 h-4 text-blue-600"}),r[6]||(r[6]=l("h3",{class:"section-title"},"搜索商品",-1))]),l("div",Oa,[l("div",Da,[r[7]||(r[7]=l("label",{class:"filter-label"},[l("span",null,"商品搜索"),l("span",{class:"text-gray-400 text-xs ml-1"},"(编码/名称)")],-1)),m(t(Xe),{modelValue:u.value,"onUpdate:modelValue":[r[0]||(r[0]=z=>u.value=z),fe],placeholder:"输入商品编码或名称"},{prefix:f(()=>[m(t(A),{name:"search",class:"w-4 h-4 text-gray-400"})]),_:1},8,["modelValue"])]),l("div",Pa,[r[8]||(r[8]=l("label",{class:"filter-label"},"品牌筛选",-1)),m(t(Ie),{modelValue:x.value,"onUpdate:modelValue":r[1]||(r[1]=z=>x.value=z),options:V.value,placeholder:"全部品牌"},null,8,["modelValue","options"])]),l("div",za,[r[9]||(r[9]=l("label",{class:"filter-label"},"分类筛选",-1)),m(t(Ie),{modelValue:_.value,"onUpdate:modelValue":r[2]||(r[2]=z=>_.value=z),options:ae.value,placeholder:"全部分类"},null,8,["modelValue","options"])])]),l("div",Ea,[l("div",Ba,[m(t(A),{name:"package",class:"w-4 h-4"}),l("span",null,[r[10]||(r[10]=D("候选商品：",-1)),l("strong",Fa,w(ke.value),1),r[11]||(r[11]=D(" 个",-1))])]),i.value.size?(n(),P(t(ee),{key:0,theme:"blue",size:"md"},{default:f(()=>[m(t(A),{name:"check-circle",class:"w-3 h-3 mr-1"}),D(" 已选 "+w(i.value.size)+" 个 ",1)]),_:1})):O("",!0)])]),l("div",Ta,[l("div",Va,[m(t(A),{name:"list",class:"w-4 h-4 text-blue-600"}),r[12]||(r[12]=l("h3",{class:"section-title"},"商品列表",-1))]),o.value?(n(),b("div",Aa,[m(t(Xs),{class:"w-6 h-6 text-blue-600"}),r[13]||(r[13]=l("span",{class:"loading-text"},"正在加载商品数据...",-1))])):le.value.length===0?(n(),b("div",qa,[m(t(A),{name:"inbox",class:"w-12 h-12 text-gray-300"}),r[14]||(r[14]=l("div",{class:"empty-title"},"没有找到商品",-1)),r[15]||(r[15]=l("div",{class:"empty-description"},"请尝试调整搜索条件或筛选器",-1))])):(n(),b("div",Ma,[l("div",Na,[m(t(Ne),{"model-value":he.value,onChange:me},null,8,["model-value"]),l("label",{class:"select-all-label",onClick:me},[r[16]||(r[16]=l("span",{class:"font-medium"},"全选当前页",-1)),l("span",Ua," (已选择 "+w(i.value.size)+" / "+w(W.value.length)+" 个) ",1)])]),l("div",La,[(n(!0),b(te,null,ie(le.value,z=>(n(),b("div",{key:z.code,class:J(["product-item",{"product-item-selected":i.value.has(z.code),"product-item-disabled":Y(z)}]),onClick:_e=>!Y(z)&&be(z.code)},[l("div",Ra,[m(t(Ne),{"model-value":i.value.has(z.code),disabled:Y(z),onChange:kt(_e=>be(z.code),["stop"])},null,8,["model-value","disabled","onChange"])]),l("div",Ka,[l("div",Ha,[l("div",Ja,[l("span",Xa,w(z.code),1),r[17]||(r[17]=l("span",{class:"product-separator"},"-",-1)),l("span",Qa,w(z.name1),1)]),Y(z)?(n(),P(t(ee),{key:0,theme:"gray",size:"xs"},{default:f(()=>[m(t(A),{name:"check",class:"w-3 h-3 mr-1"}),r[18]||(r[18]=D(" 已存在 ",-1))]),_:1})):O("",!0)]),l("div",Ga,[z.specifications?(n(),b("div",Wa,[m(t(A),{name:"box",class:"w-3 h-3"}),l("span",null,w(z.specifications),1)])):O("",!0),z.brand?(n(),b("div",Ya,[m(t(A),{name:"tag",class:"w-3 h-3"}),l("span",null,w(z.brand),1)])):O("",!0),z.category?(n(),b("div",Za,[m(t(A),{name:"folder",class:"w-3 h-3"}),l("span",null,w(z.category),1)])):O("",!0)])])],10,ja))),128))])]))]),ce.value>1?(n(),b("div",el,[l("div",tl,[r[19]||(r[19]=D(" 显示 ",-1)),l("strong",null,w(we.value),1),r[20]||(r[20]=D(" - ",-1)),l("strong",null,w(re.value),1),r[21]||(r[21]=D(" 条， 共 ",-1)),l("strong",null,w(W.value.length),1),r[22]||(r[22]=D(" 条 ",-1))]),l("div",sl,[m(t(M),{variant:"ghost",theme:"gray","icon-left":"chevron-left",size:"sm",disabled:I.value===1,onClick:r[3]||(r[3]=z=>pe(I.value-1))},{default:f(()=>[...r[23]||(r[23]=[D(" 上一页 ",-1)])]),_:1},8,["disabled"]),l("div",al,[l("span",ll,w(I.value),1),r[24]||(r[24]=l("span",{class:"page-separator"},"/",-1)),l("span",ol,w(ce.value),1)]),m(t(M),{variant:"ghost",theme:"gray","icon-right":"chevron-right",size:"sm",disabled:I.value===ce.value,onClick:r[4]||(r[4]=z=>pe(I.value+1))},{default:f(()=>[...r[25]||(r[25]=[D(" 下一页 ",-1)])]),_:1},8,["disabled"])])])):O("",!0)])]),actions:f(()=>[l("div",nl,[m(t(M),{variant:"subtle",theme:"gray","icon-left":"x",onClick:oe},{default:f(()=>[...r[26]||(r[26]=[D(" 取消 ",-1)])]),_:1}),m(t(M),{variant:"solid",theme:"blue","icon-left":"check",disabled:i.value.size===0||d.value,loading:d.value,onClick:Ce},{default:f(()=>[d.value?(n(),b("span",rl,"添加中...")):(n(),b("span",il,"确认添加 ("+w(i.value.size)+")",1))]),_:1},8,["disabled","loading"])])]),_:1},8,["modelValue"]))}},dl=ne(ul,[["__scopeId","data-v-f7378565"]]),cl={key:0,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pl={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},fl={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ml={class:"text-sm font-medium"},gl={__name:"SaveIndicator",props:{isSaving:{type:Boolean,default:!1},saveError:{type:String,default:null},lastSaveTime:{type:Date,default:null}},setup(s){const a=s,e=B(!1),p=B(null),o=C(()=>a.isSaving?"bg-blue-50 text-blue-700 border border-blue-200":a.saveError?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"),d=C(()=>a.isSaving?"正在保存...":a.saveError?`保存失败: ${a.saveError}`:a.lastSaveTime?"保存成功":"");return se(()=>a.isSaving,g=>{g&&(e.value=!0,p.value&&(clearTimeout(p.value),p.value=null))}),se(()=>a.lastSaveTime,g=>{g&&!a.isSaving&&(e.value=!0,p.value&&clearTimeout(p.value),p.value=setTimeout(()=>{e.value=!1},2e3))}),se(()=>a.saveError,g=>{g&&!a.isSaving&&(e.value=!0,p.value&&clearTimeout(p.value),p.value=setTimeout(()=>{e.value=!1},5e3))}),(g,i)=>(n(),P(wt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:f(()=>[e.value?(n(),b("div",{key:0,class:J(["save-indicator fixed top-20 right-6 z-50 flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg",o.value])},[s.isSaving?(n(),b("svg",cl,[...i[0]||(i[0]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):s.saveError?(n(),b("svg",fl,[...i[2]||(i[2]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])):(n(),b("svg",pl,[...i[1]||(i[1]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),l("span",ml,w(d.value),1)],2)):O("",!0)]),_:1}))}},vl=ne(gl,[["__scopeId","data-v-4287462e"]]),yl={class:"store-detail-page min-h-screen bg-gray-50 p-4 lg:p-6"},hl={class:"max-w-[1920px] mx-auto space-y-4"},bl={class:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between"},_l={class:"flex items-start gap-3"},xl={class:"flex items-center gap-2 flex-wrap"},kl={class:"text-xl font-semibold text-gray-900"},wl={class:"text-sm text-gray-500 flex items-center gap-2 mt-1"},Cl={class:"flex flex-wrap items-center gap-2"},$l={class:"hidden md:flex flex-wrap items-center gap-2"},Sl={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},Il={class:"flex items-center gap-3"},Ol={class:"flex items-center gap-2"},Dl={class:"text-sm text-gray-500"},Pl={class:"border-b border-gray-100 px-5 py-3 bg-gray-50"},zl={class:"flex items-center justify-between"},El={class:"flex items-center gap-2 text-gray-900 font-medium"},Bl={class:"p-4"},Fl={class:"overflow-x-auto"},Tl={class:"min-w-full divide-y divide-gray-200"},Vl={class:"bg-gray-50"},Al={class:"bg-white divide-y divide-gray-200"},ql={key:0,class:"text-center py-12 text-gray-500"},Ml={class:"space-y-3"},Nl={class:"text-sm text-gray-600"},Ul={class:"text-gray-900"},Ll={class:"p-3 bg-red-50 rounded-lg border border-red-100"},jl={class:"flex items-start gap-2"},Rl={__name:"StoreDetail",props:{storeId:{type:String,required:!0},taskId:{type:String,required:!0}},setup(s){const a=s,e=Ct(),{filters:p,pagination:o,filteredCommodities:d,storeInfo:g,taskInfo:i,canEdit:u,statistics:v,totalPages:x,totalCount:_,loading:I,error:y,filterOptions:S,isSaving:k,saveError:F,lastSaveTime:U,selectedCount:V,hasSelection:ae,refreshData:ye,updateFilters:Y,updatePagination:W,exportToExcel:ke,generateColumns:le,generateHeaders:ce,transformDataForTable:we,updateSelectedRows:re,batchDeleteSelected:he,cleanup:Z}=Ws(a.storeId,a.taskId),be=C(()=>le()),me=C(()=>ce()),pe=C(()=>we()),Ce=C(()=>{var T;return y.value?typeof y.value=="string"?y.value:((T=y.value)==null?void 0:T.message)||"加载失败":""}),oe=B(!1),fe=B(!1),h=B(!1),r=B(!1),z=B(!1),_e=C(()=>[{label:"批量删除",icon:"trash",disabled:!u.value||!ae.value,onClick:()=>{if(!u.value){j.warning("当前审批状态不可编辑");return}if(!ae.value){j.info("请选择要删除的商品");return}h.value=!0}},{label:"单品导入",icon:"upload",disabled:!u.value,onClick:()=>oe.value=!0},{label:"添加商品",icon:"plus",disabled:!u.value,onClick:()=>fe.value=!0},{label:"导出Excel",icon:"download",disabled:r.value,onClick:()=>q()},{label:"刷新",icon:"refresh-cw",onClick:()=>E()}]),c=()=>H(this,null,function*(){try{Z&&typeof Z=="function"&&Z(),yield e.push({name:"Dashboard"})}catch(T){console.error("导航失败:",T);try{yield e.push("/")}catch($){console.error("备用导航也失败:",$),j.error("返回失败，请刷新页面")}}}),E=()=>H(this,null,function*(){yield ye(),j.info("数据已刷新")}),X=()=>H(this,null,function*(){yield ye(),j.success("导入成功，数据已更新")}),q=()=>H(this,null,function*(){r.value=!0;try{const T=yield ke();T.success?j.success(T.message||"导出成功"):j.error(T.message||"导出失败")}catch(T){j.error(T.message||"导出失败")}finally{r.value=!1}}),K=()=>H(this,null,function*(){if(V.value===0){h.value=!1;return}z.value=!0;try{const T=yield he();T.success?(j.success(T.message||"删除成功"),h.value=!1):j.error(T.message||"删除失败")}catch(T){j.error(T.message||"删除失败")}finally{z.value=!1}}),xe=T=>Gs(T);return se([p,o],()=>{re([])},{deep:!0}),De(()=>H(this,null,function*(){})),$t(()=>{try{Z&&typeof Z=="function"&&Z()}catch(T){console.error("组件卸载清理失败:",T)}}),(T,$)=>(n(),b("div",yl,[l("div",hl,[m(t(ge),{class:"p-4 lg:p-5"},{default:f(()=>[l("div",bl,[l("div",_l,[m(t(M),{variant:"ghost",theme:"gray",size:"sm",onClick:c},{prefix:f(()=>[m(t(A),{name:"arrow-left",class:"h-4 w-4"})]),default:f(()=>[$[9]||($[9]=D(" 返回看板 ",-1))]),_:1}),l("div",null,[l("div",xl,[l("h1",kl,w(t(g).shop_name||t(g).name||"店铺详情"),1),t(i).task_type?(n(),P(t(ee),{key:0,theme:"blue",size:"sm"},{default:f(()=>[D(w(t(i).task_type),1)]),_:1})):O("",!0)]),l("div",wl,[m(t(A),{name:"calendar",class:"w-4 h-4"}),l("span",null,w(t(i).task_name||t(i).name||"任务信息加载中"),1)])])]),l("div",Cl,[l("div",$l,[t(u)?(n(),P(t(M),{key:0,variant:"outline",theme:"blue",onClick:$[0]||($[0]=L=>oe.value=!0)},{prefix:f(()=>[m(t(A),{name:"upload",class:"h-4 w-4"})]),default:f(()=>[$[10]||($[10]=D(" 单品导入 ",-1))]),_:1})):O("",!0),t(u)?(n(),P(t(M),{key:1,variant:"outline",theme:"purple",onClick:$[1]||($[1]=L=>fe.value=!0)},{prefix:f(()=>[m(t(A),{name:"plus",class:"h-4 w-4"})]),default:f(()=>[$[11]||($[11]=D(" 添加商品 ",-1))]),_:1})):O("",!0),m(t(M),{variant:"outline",theme:"green",loading:r.value,onClick:q},{prefix:f(()=>[m(t(A),{name:"download",class:"h-4 w-4"})]),default:f(()=>[$[12]||($[12]=D(" 导出Excel ",-1))]),_:1},8,["loading"]),m(t(M),{variant:"ghost",theme:"gray",onClick:E},{prefix:f(()=>[m(t(A),{name:"refresh-cw",class:"h-4 w-4"})]),default:f(()=>[$[13]||($[13]=D(" 刷新 ",-1))]),_:1})]),m(t(St),{class:"md:hidden",options:_e.value,placement:"bottom-end"},{default:f(({open:L})=>[m(t(M),{variant:"outline",theme:"gray"},{prefix:f(()=>[m(t(A),{name:"more-horizontal",class:"h-4 w-4"})]),default:f(()=>[D(" "+w(L?"收起":"操作"),1)]),_:2},1024)]),_:1},8,["options"])])])]),_:1}),t(y)?(n(),P(t(ze),{key:0,theme:"red",title:"加载失败"},{default:f(()=>[D(w(Ce.value),1)]),_:1})):O("",!0),t(I)?(n(),P(t(ge),{key:1,class:"p-6 flex items-center justify-center"},{default:f(()=>[...$[14]||($[14]=[l("div",{class:"flex items-center gap-3 text-gray-600"},[l("div",{class:"h-5 w-5 animate-spin rounded-full border-2 border-gray-200 border-t-blue-600"}),l("span",null,"正在加载数据...")],-1)])]),_:1})):(n(),b(te,{key:2},[m(ra,{statistics:t(v)},null,8,["statistics"]),m(aa,{filters:t(p),"filter-options":t(S),loading:t(I),"onUpdate:filters":t(Y)},null,8,["filters","filter-options","loading","onUpdate:filters"]),m(t(ge),{class:"p-4"},{default:f(()=>[l("div",Sl,[l("div",Il,[t(u)&&t(ae)?(n(),P(t(M),{key:0,variant:"solid",theme:"red",size:"sm",onClick:$[2]||($[2]=L=>h.value=!0)},{prefix:f(()=>[m(t(A),{name:"trash-2",class:"h-4 w-4"})]),default:f(()=>[D(" 删除选中 ("+w(t(V))+") ",1)]),_:1})):O("",!0),t(ae)?(n(),P(t(ee),{key:1,theme:"blue",variant:"subtle"},{default:f(()=>[D(" 已选择 "+w(t(V))+" 项 ",1)]),_:1})):O("",!0)]),l("div",Ol,[l("div",Dl," 共 "+w(t(_))+" 条数据 ",1)])])]),_:1}),m(t(ge),{class:"overflow-hidden"},{default:f(()=>[l("div",Pl,[l("div",zl,[l("div",El,[m(t(A),{name:"table",class:"h-4 w-4 text-gray-500"}),$[15]||($[15]=l("span",null,"商品计划数据",-1))]),t(k)?(n(),P(t(ee),{key:0,theme:"blue",variant:"subtle"},{prefix:f(()=>[...$[16]||($[16]=[l("div",{class:"h-3 w-3 animate-spin rounded-full border-2 border-blue-100 border-t-blue-600"},null,-1)])]),default:f(()=>[$[17]||($[17]=D(" 保存中... ",-1))]),_:1})):t(F)?(n(),P(t(ee),{key:1,theme:"red",variant:"subtle"},{prefix:f(()=>[m(t(A),{name:"alert-circle",class:"h-3 w-3"})]),default:f(()=>[$[18]||($[18]=D(" 保存失败 ",-1))]),_:1})):t(U)?(n(),P(t(ee),{key:2,theme:"green",variant:"subtle"},{prefix:f(()=>[m(t(A),{name:"check",class:"h-3 w-3"})]),default:f(()=>[D(" "+w(xe(t(U))),1)]),_:1})):O("",!0)])]),l("div",Bl,[l("div",Fl,[l("table",Tl,[l("thead",Vl,[l("tr",null,[(n(!0),b(te,null,ie(me.value,L=>(n(),b("th",{key:L,class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},w(L),1))),128))])]),l("tbody",Al,[(n(!0),b(te,null,ie(pe.value,(L,$e)=>(n(),b("tr",{key:$e},[(n(!0),b(te,null,ie(be.value,(Qe,Ge)=>(n(),b("td",{key:Ge,class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},w(L[Qe.data]||"-"),1))),128))]))),128))])])]),!pe.value||pe.value.length===0?(n(),b("div",ql," 暂无数据 ")):O("",!0)])]),_:1}),m(fa,{"current-page":t(o).currentPage,"page-size":t(o).pageSize,"total-items":t(_),"total-pages":t(x),"page-size-options":t(o).pageSizeOptions,"onUpdate:currentPage":$[3]||($[3]=L=>t(W)({currentPage:L})),"onUpdate:pageSize":$[4]||($[4]=L=>t(W)({pageSize:L}))},null,8,["current-page","page-size","total-items","total-pages","page-size-options"])],64)),m(Ca,{show:oe.value,"store-id":s.storeId,"task-id":s.taskId,onClose:$[5]||($[5]=L=>oe.value=!1),onSuccess:X},null,8,["show","store-id","task-id"]),m(dl,{show:fe.value,"store-id":s.storeId,"task-id":s.taskId,"existing-products":t(d),onClose:$[6]||($[6]=L=>fe.value=!1),onSuccess:X},null,8,["show","store-id","task-id","existing-products"]),m(t(Se),{modelValue:h.value,"onUpdate:modelValue":$[8]||($[8]=L=>h.value=L),title:"确认批量删除"},{"body-content":f(()=>[l("div",Ml,[l("p",Nl,[$[19]||($[19]=D(" 确定删除选中的 ",-1)),l("strong",Ul,w(t(V)),1),$[20]||($[20]=D(" 个商品的所有计划记录吗？ ",-1))]),l("div",Ll,[l("div",jl,[m(t(A),{name:"alert-triangle",class:"h-4 w-4 text-red-600 mt-0.5"}),$[21]||($[21]=l("p",{class:"text-sm text-red-800"}," 该操作不可撤销,请谨慎操作！ ",-1))])])])]),actions:f(()=>[m(t(M),{variant:"subtle",theme:"gray",onClick:$[7]||($[7]=L=>h.value=!1)},{default:f(()=>[...$[22]||($[22]=[D(" 取消 ",-1)])]),_:1}),m(t(M),{variant:"solid",theme:"red",loading:z.value,onClick:K},{default:f(()=>[...$[23]||($[23]=[D(" 确认删除 ",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"]),m(vl,{"is-saving":t(k),"save-error":t(F),"last-save-time":t(U)},null,8,["is-saving","save-error","last-save-time"])])]))}},Jl=ne(Rl,[["__scopeId","data-v-3156795f"]]);export{Jl as default};
