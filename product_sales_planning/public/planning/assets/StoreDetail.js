var ee=Object.defineProperty;var T=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var Q=(n,o,s)=>o in n?ee(n,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[o]=s,z=(n,o)=>{for(var s in o||(o={}))te.call(o,s)&&Q(n,s,o[s]);if(T)for(var s of T(o))se.call(o,s)&&Q(n,s,o[s]);return n};var O=(n,o,s)=>new Promise((r,d)=>{var i=a=>{try{f(s.next(a))}catch(v){d(v)}},C=a=>{try{f(s.throw(a))}catch(v){d(v)}},f=a=>a.done?r(a.value):Promise.resolve(a.value).then(i,C);f((s=s.apply(n,o)).next())});import{r as P,c as ae,a as k,w as E,b as J,o as oe,d as ne,_ as U,e as b,f as w,g as e,t as S,h as N,v as re,i as L,F as B,j as R,n as le,u as ie,k as W,l as h,m as G,p as F}from"./index.js";function de(n,o){const s=P({search:"",mechanism:"",category:""}),r=P({currentPage:1,pageSize:50,pageSizeOptions:[20,50,100,200]}),d=P({hiddenColumns:[]}),i=ae({url:"product_sales_planning.planning_system.page.store_detail.store_detail.get_store_commodity_data",params:()=>({store_id:n,task_id:o,view_mode:"multi"}),auto:!0,transform:t=>(console.log("API 返回的原始数据:",t),t?{commodities:t.data||[],months:t.months||[],store_info:t.store_info||{},task_info:t.task_info||{},can_edit:t.can_edit!==void 0?t.can_edit:!0,edit_reason:t.edit_reason||"",approval_status:t.approval_status||{}}:{commodities:[],months:[],store_info:{},task_info:{},can_edit:!1,edit_reason:"",approval_status:{}})}),C=k(()=>{const t=f.value,c=new Set,x=new Set;return t.forEach(y=>{y.mechanism&&c.add(y.mechanism),y.category&&x.add(y.category)}),{mechanisms:Array.from(c).sort(),categories:Array.from(x).sort()}}),f=k(()=>{var t;return((t=i.data)==null?void 0:t.commodities)||[]}),a=k(()=>{var t;return((t=i.data)==null?void 0:t.months)||[]}),v=k(()=>{var t;return((t=i.data)==null?void 0:t.store_info)||{}}),g=k(()=>{var t;return((t=i.data)==null?void 0:t.task_info)||{}}),l=k(()=>{var t;return((t=i.data)==null?void 0:t.can_edit)||!1}),u=k(()=>{var t;return((t=i.data)==null?void 0:t.approval_status)||{}}),p=k(()=>{let t=f.value;if(s.value.search){const c=s.value.search.toLowerCase();t=t.filter(x=>(x.code||"").toLowerCase().includes(c)||(x.name1||"").toLowerCase().includes(c))}return s.value.mechanism&&(t=t.filter(c=>c.mechanism===s.value.mechanism)),s.value.category&&(t=t.filter(c=>c.category===s.value.category)),t}),m=k(()=>{const t=(r.value.currentPage-1)*r.value.pageSize,c=t+r.value.pageSize;return p.value.slice(t,c)}),j=k(()=>Math.ceil(p.value.length/r.value.pageSize)),_=k(()=>{const t=p.value;let c=0;return t.forEach(x=>{x.months&&Object.values(x.months).forEach(y=>{const M=(y==null?void 0:y.quantity)||0;c+=Number(M)})}),{totalSKU:t.length,totalQuantity:c,plannedSKU:t.filter(x=>x.months?Object.values(x.months).some(y=>((y==null?void 0:y.quantity)||0)>0):!1).length}}),$=()=>O(null,null,function*(){yield i.reload()}),I=t=>{s.value=z(z({},s.value),t),r.value.currentPage=1},D=t=>{r.value=z(z({},r.value),t)},V=(t,c,x)=>O(null,null,function*(){try{const y=yield J("product_sales_planning.planning_system.page.store_detail.store_detail.update_month_quantity",{store_id:n,task_id:o,code:t,month:c,quantity:x});return y&&y.status==="success"?{success:!0,message:"保存成功"}:{success:!1,message:(y==null?void 0:y.message)||"保存失败"}}catch(y){return console.error("保存失败:",y),{success:!1,message:y.message||"保存失败"}}}),q=t=>O(null,null,function*(){try{const c=t.map(([y,M,mt,X])=>{const Y=m.value[y],Z=a.value[M-2];return{code:Y.commodity_code,month:Z,quantity:X}}),x=yield J("product_sales_planning.planning_system.page.store_detail.store_detail.batch_update_quantities",{store_id:n,task_id:o,updates:JSON.stringify(c)});return x&&x.status==="success"?{success:!0,message:"批量保存成功"}:{success:!1,message:(x==null?void 0:x.message)||"批量保存失败"}}catch(c){return console.error("批量保存失败:",c),{success:!1,message:c.message||"批量保存失败"}}}),A=()=>{const t=[{data:"code",title:"商品编码",readOnly:!0,width:120},{data:"name1",title:"商品名称",readOnly:!0,width:200}];return a.value.forEach(c=>{t.push({data:c,title:c,type:"numeric",readOnly:!l.value,width:100,numericFormat:{pattern:"0,0"}})}),t},K=()=>{const t=["商品编码","商品名称"];return a.value.forEach(c=>{t.push(c)}),t},H=()=>m.value.map(t=>{const c={code:t.code,name1:t.name1};return a.value.forEach(x=>{var M;const y=(M=t.months)==null?void 0:M[x];c[x]=(y==null?void 0:y.quantity)||0}),c});return E(s,()=>{r.value.currentPage=1},{deep:!0}),{filters:s,pagination:r,columnSettings:d,rawCommodities:f,filteredCommodities:p,paginatedCommodities:m,months:a,storeInfo:v,taskInfo:g,canEdit:l,approvalStatus:u,statistics:_,totalPages:j,loading:k(()=>i.loading),error:k(()=>i.error),filterOptions:C,refreshData:$,updateFilters:I,updatePagination:D,saveMonthQuantity:V,batchSaveChanges:q,generateColumns:A,generateHeaders:K,transformDataForTable:H}}function ue(){return new Promise((n,o)=>{if(window.Handsontable){console.log("✅ Handsontable already loaded"),n();return}const s=(d,i)=>new Promise((C,f)=>{if(document.getElementById(d)){C();return}const a=document.createElement("link");a.id=d,a.rel="stylesheet",a.href=i,a.onload=()=>{console.log(`✅ CSS loaded: ${i}`),C()},a.onerror=()=>f(new Error(`Failed to load CSS: ${i}`)),document.head.appendChild(a)}),r=d=>new Promise((i,C)=>{if(window.Handsontable){i();return}const f=document.createElement("script");f.src=d,f.onload=()=>{console.log(`✅ JS loaded: ${d}`),i()},f.onerror=()=>C(new Error(`Failed to load JS: ${d}`)),document.head.appendChild(f)});Promise.resolve().then(()=>s("handsontable-css","/assets/product_sales_planning/js/lib/handsontable.full.min.css")).then(()=>r("/assets/product_sales_planning/js/lib/handsontable.full.min.js")).then(()=>{console.log("✅ All Handsontable resources loaded"),n()}).catch(o),setTimeout(()=>{o(new Error("Handsontable 资源加载超时，请检查网络或刷新页面"))},1e4)})}function ce(n,o={}){const s=P(null),r=P(!0),d=P(null),i=P(!1),C=()=>O(null,null,function*(){try{if(r.value=!0,d.value=null,yield ue(),!n.value)throw new Error("Container element not found");if(!n.value.parentNode)throw new Error("Container element not mounted to DOM");if(!window.Handsontable)throw new Error("Handsontable library not loaded");if(s.value&&!i.value)try{s.value.destroy(),s.value=null,console.log("✅ Old Handsontable instance destroyed")}catch(_){console.warn("⚠️ Failed to destroy old instance:",_)}const m=_=>_&&typeof _=="object"&&"value"in _?_.value:_,j=z({data:m(o.data)||[],columns:m(o.columns)||[],colHeaders:m(o.colHeaders)!==!1,rowHeaders:m(o.rowHeaders)!==!1,fixedColumnsLeft:o.fixedColumnsLeft||2,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!1,autoWrapCol:!1,manualColumnResize:!0,manualRowResize:!0,contextMenu:o.contextMenu!==!1,dropdownMenu:o.dropdownMenu||!1,filters:o.filters||!1,columnSorting:o.columnSorting||!1,renderAllRows:!1,viewportRowRenderingOffset:30,viewportColumnRenderingOffset:10,afterChange:(_,$)=>{$!=="loadData"&&o.onDataChange&&o.onDataChange(_,$)},afterSelection:(_,$,I,D)=>{o.onSelection&&o.onSelection(_,$,I,D)}},o.config?Object.keys(o.config).reduce((_,$)=>(_[$]=m(o.config[$]),_),{}):{});s.value=new window.Handsontable(n.value,j),i.value=!1,console.log("✅ Handsontable initialized successfully"),r.value=!1}catch(m){console.error("❌ Handsontable initialization error:",m),d.value=m.message,r.value=!1}}),f=m=>{s.value&&!i.value&&s.value.loadData(m)},a=m=>{s.value&&!i.value&&s.value.updateSettings({columns:m})},v=()=>s.value&&!i.value?s.value.getData():[],g=(m,j)=>s.value&&!i.value?s.value.getDataAtCell(m,j):null,l=(m,j,_)=>{s.value&&!i.value&&s.value.setDataAtCell(m,j,_)},u=()=>{s.value&&!i.value&&s.value.render()},p=()=>{s.value&&!i.value&&(s.value.destroy(),s.value=null,i.value=!0,console.log("✅ Handsontable destroyed"))};return oe(()=>{C()}),ne(()=>{p()}),o.data&&E(()=>o.data,m=>{m&&s.value&&!r.value&&f(m)},{deep:!0}),o.columns&&E(()=>o.columns,m=>{m&&s.value&&!r.value&&a(m)},{deep:!0}),{hotInstance:s,loading:r,error:d,updateData:f,updateColumns:a,getData:v,getDataAtCell:g,setDataAtCell:l,render:u,destroy:p}}const ge={class:"commodity-table-wrapper"},me={key:0,class:"flex items-center justify-center py-12"},fe={key:1,class:"flex items-center justify-center py-12"},pe={class:"text-red-500"},ve={key:2,class:"handsontable-container"},ye={__name:"CommodityTable",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},headers:{type:Array,default:()=>[]},canEdit:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},error:{type:String,default:null}},emits:["dataChange","selection"],setup(n,{expose:o,emit:s}){const r=n,d=s,i=P(null),C=(l,u)=>{console.log("Table data changed:",l,u),d("dataChange",l,u)},f=(l,u,p,m)=>{d("selection",l,u,p,m)},{hotInstance:a,loading:v,updateData:g}=ce(i,{data:k(()=>r.data),columns:k(()=>r.columns),colHeaders:k(()=>r.headers),onDataChange:C,onSelection:f,config:{readOnly:k(()=>!r.canEdit)}});return E(()=>r.data,l=>{l&&a.value&&!v.value&&g(l)},{deep:!0}),o({hotInstance:a,updateData:g}),(l,u)=>(w(),b("div",ge,[n.loading?(w(),b("div",me,[...u[0]||(u[0]=[e("div",{class:"text-gray-500"},"正在加载表格数据...",-1)])])):n.error?(w(),b("div",fe,[e("div",pe,S(n.error),1)])):(w(),b("div",ve,[e("div",{ref_key:"tableContainer",ref:i,class:"w-full"},null,512)]))]))}},he=U(ye,[["__scopeId","data-v-7dbd32f2"]]),be={class:"filter-panel bg-white rounded-lg shadow p-4 mb-4"},we={class:"flex flex-wrap gap-4 items-end"},xe={class:"flex-1 min-w-[200px]"},_e={class:"w-48"},ke=["value"],Ce={class:"w-48"},Se=["value"],$e={__name:"FilterPanel",props:{filters:{type:Object,default:()=>({search:"",mechanism:"",category:""})},filterOptions:{type:Object,default:()=>({mechanisms:[],categories:[]})}},emits:["update:filters"],setup(n,{emit:o}){const s=n,r=o,d=P(z({},s.filters));E(()=>s.filters,f=>{d.value=z({},f)},{deep:!0});const i=()=>{r("update:filters",z({},d.value))},C=()=>{d.value={search:"",mechanism:"",category:""},i()};return(f,a)=>(w(),b("div",be,[e("div",we,[e("div",xe,[a[3]||(a[3]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 搜索商品 ",-1)),N(e("input",{"onUpdate:modelValue":a[0]||(a[0]=v=>d.value.search=v),type:"text",placeholder:"输入商品编码或名称...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:i},null,544),[[re,d.value.search]])]),e("div",_e,[a[5]||(a[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 机制 ",-1)),N(e("select",{"onUpdate:modelValue":a[1]||(a[1]=v=>d.value.mechanism=v),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:i},[a[4]||(a[4]=e("option",{value:""},"全部",-1)),(w(!0),b(B,null,R(n.filterOptions.mechanisms,v=>(w(),b("option",{key:v,value:v},S(v),9,ke))),128))],544),[[L,d.value.mechanism]])]),e("div",Ce,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 分类 ",-1)),N(e("select",{"onUpdate:modelValue":a[2]||(a[2]=v=>d.value.category=v),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:i},[a[6]||(a[6]=e("option",{value:""},"全部",-1)),(w(!0),b(B,null,R(n.filterOptions.categories,v=>(w(),b("option",{key:v,value:v},S(v),9,Se))),128))],544),[[L,d.value.category]])]),e("div",null,[e("button",{onClick:C,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors"}," 重置 ")])])]))}},Pe=U($e,[["__scopeId","data-v-4dd1893c"]]),je={class:"stats-cards grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},ze={class:"stat-card bg-white rounded-lg shadow p-4"},He={class:"flex items-center justify-between"},Oe={class:"text-2xl font-bold text-gray-900"},Me={class:"stat-card bg-white rounded-lg shadow p-4"},Ee={class:"flex items-center justify-between"},Ie={class:"text-2xl font-bold text-green-600"},De={class:"stat-card bg-white rounded-lg shadow p-4"},Be={class:"flex items-center justify-between"},Ue={class:"text-2xl font-bold text-purple-600"},Ae={__name:"StatsCards",props:{statistics:{type:Object,default:()=>({totalSKU:0,plannedSKU:0,totalQuantity:0})}},setup(n){const o=s=>s?s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0";return(s,r)=>(w(),b("div",je,[e("div",ze,[e("div",He,[e("div",null,[r[0]||(r[0]=e("div",{class:"text-sm text-gray-500 mb-1"},"总 SKU 数",-1)),e("div",Oe,S(n.statistics.totalSKU),1)]),r[1]||(r[1]=e("div",{class:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])],-1))])]),e("div",Me,[e("div",Ee,[e("div",null,[r[2]||(r[2]=e("div",{class:"text-sm text-gray-500 mb-1"},"已规划 SKU",-1)),e("div",Ie,S(n.statistics.plannedSKU),1)]),r[3]||(r[3]=e("div",{class:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),e("div",De,[e("div",Be,[e("div",null,[r[4]||(r[4]=e("div",{class:"text-sm text-gray-500 mb-1"},"总计划量",-1)),e("div",Ue,S(o(n.statistics.totalQuantity)),1)]),r[5]||(r[5]=e("div",{class:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})])],-1))])])]))}},Fe=U(Ae,[["__scopeId","data-v-57b36da1"]]),Ne={class:"pagination-controls bg-white rounded-lg shadow p-4 flex items-center justify-between"},Re={class:"flex items-center gap-2"},Ve=["value"],qe={class:"text-sm text-gray-600"},Ke={class:"flex items-center gap-2"},Le=["disabled"],Te=["disabled"],Qe={class:"flex items-center gap-1"},Je=["onClick"],We={key:1,class:"px-2 text-gray-500"},Ge=["disabled"],Xe=["disabled"],Ye={__name:"PaginationControls",props:{currentPage:{type:Number,default:1},pageSize:{type:Number,default:50},totalItems:{type:Number,default:0},totalPages:{type:Number,default:1},pageSizeOptions:{type:Array,default:()=>[20,50,100,200]}},emits:["update:currentPage","update:pageSize"],setup(n,{emit:o}){const s=n,r=o,d=P(s.pageSize),i=k(()=>(s.currentPage-1)*s.pageSize+1),C=k(()=>{const g=s.currentPage*s.pageSize;return g>s.totalItems?s.totalItems:g}),f=k(()=>{const g=[],l=s.totalPages,u=s.currentPage;if(l<=7)for(let p=1;p<=l;p++)g.push(p);else if(u<=4){for(let p=1;p<=5;p++)g.push(p);g.push("..."),g.push(l)}else if(u>=l-3){g.push(1),g.push("...");for(let p=l-4;p<=l;p++)g.push(p)}else{g.push(1),g.push("...");for(let p=u-1;p<=u+1;p++)g.push(p);g.push("..."),g.push(l)}return g}),a=g=>{g>=1&&g<=s.totalPages&&g!==s.currentPage&&r("update:currentPage",g)},v=()=>{r("update:pageSize",d.value),r("update:currentPage",1)};return E(()=>s.pageSize,g=>{d.value=g}),(g,l)=>(w(),b("div",Ne,[e("div",Re,[l[5]||(l[5]=e("span",{class:"text-sm text-gray-600"},"每页显示",-1)),N(e("select",{"onUpdate:modelValue":l[0]||(l[0]=u=>d.value=u),onChange:v,class:"px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[(w(!0),b(B,null,R(n.pageSizeOptions,u=>(w(),b("option",{key:u,value:u},S(u),9,Ve))),128))],544),[[L,d.value]]),l[6]||(l[6]=e("span",{class:"text-sm text-gray-600"},"条",-1))]),e("div",qe," 显示 "+S(i.value)+" - "+S(C.value)+" 条，共 "+S(n.totalItems)+" 条 ",1),e("div",Ke,[e("button",{onClick:l[1]||(l[1]=u=>a(1)),disabled:n.currentPage===1,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"首页"},[...l[7]||(l[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})],-1)])],8,Le),e("button",{onClick:l[2]||(l[2]=u=>a(n.currentPage-1)),disabled:n.currentPage===1,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"上一页"},[...l[8]||(l[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,Te),e("div",Qe,[(w(!0),b(B,null,R(f.value,u=>(w(),b(B,{key:u},[u!=="..."?(w(),b("button",{key:0,onClick:p=>a(u),class:le(["px-3 py-1 border rounded-md",u===n.currentPage?"bg-blue-500 text-white border-blue-500":"border-gray-300 hover:bg-gray-50"])},S(u),11,Je)):(w(),b("span",We,"..."))],64))),128))]),e("button",{onClick:l[3]||(l[3]=u=>a(n.currentPage+1)),disabled:n.currentPage===n.totalPages,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"下一页"},[...l[9]||(l[9]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Ge),e("button",{onClick:l[4]||(l[4]=u=>a(n.totalPages)),disabled:n.currentPage===n.totalPages,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"末页"},[...l[10]||(l[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})],-1)])],8,Xe)])]))}},Ze=U(Ye,[["__scopeId","data-v-5e3a3c82"]]),et={class:"store-detail-page min-h-screen bg-gray-50 p-6"},tt={class:"page-header mb-6"},st={class:"flex items-center justify-between"},at={class:"flex items-center gap-4"},ot={class:"text-2xl font-bold text-gray-900"},nt={class:"text-sm text-gray-500 mt-1"},rt={key:0},lt={class:"flex items-center gap-2"},it={key:0,class:"flex items-center justify-center py-20"},dt={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center"},ut={class:"text-red-600 text-lg font-medium"},ct={key:2,class:"space-y-4"},gt={__name:"StoreDetail",props:{storeId:{type:String,required:!0},taskId:{type:String,required:!0}},setup(n){const o=n,s=ie(),{filters:r,pagination:d,filteredCommodities:i,storeInfo:C,taskInfo:f,canEdit:a,statistics:v,totalPages:g,loading:l,error:u,filterOptions:p,refreshData:m,updateFilters:j,updatePagination:_,batchSaveChanges:$,generateColumns:I,generateHeaders:D,transformDataForTable:V}=de(o.storeId,o.taskId),q=()=>{s.push("/")},A=()=>O(null,null,function*(){yield m()}),K=(H,t)=>O(null,null,function*(){if(console.log("Data changed:",H,t),H&&H.length>0){const c=yield $(H);c.success?console.log("保存成功"):console.error("保存失败:",c.message)}});return(H,t)=>(w(),b("div",et,[e("div",tt,[e("div",st,[e("div",at,[e("button",{onClick:q,class:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white rounded-md shadow hover:bg-gray-50 transition-colors"},[...t[2]||(t[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),W(" 返回看板 ",-1)])]),e("div",null,[e("h1",ot,S(h(C).shop_name||h(C).name||"店铺详情"),1),e("p",nt,[W(S(h(f).task_name||h(f).name||"")+" ",1),h(f).task_type?(w(),b("span",rt," - "+S(h(f).task_type),1)):G("",!0)])])]),e("div",lt,[h(a)?(w(),b("button",{key:0,onClick:A,class:"px-4 py-2 text-gray-700 bg-white rounded-md shadow hover:bg-gray-50 transition-colors",title:"刷新数据"},[...t[3]||(t[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])):G("",!0)])])]),h(l)?(w(),b("div",it,[...t[4]||(t[4]=[e("div",{class:"text-center"},[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),e("div",{class:"mt-4 text-gray-600"},"正在加载数据...")],-1)])])):h(u)?(w(),b("div",dt,[e("div",ut,S(h(u)),1),e("button",{onClick:A,class:"mt-4 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors"}," 重试 ")])):(w(),b("div",ct,[F(Fe,{statistics:h(v)},null,8,["statistics"]),F(Pe,{filters:h(r),"filter-options":h(p),"onUpdate:filters":h(j)},null,8,["filters","filter-options","onUpdate:filters"]),F(he,{data:h(V)(),columns:h(I)(),headers:h(D)(),"can-edit":h(a),loading:h(l),error:h(u),onDataChange:K},null,8,["data","columns","headers","can-edit","loading","error"]),F(Ze,{"current-page":h(d).currentPage,"page-size":h(d).pageSize,"total-items":h(i).length,"total-pages":h(g),"page-size-options":h(d).pageSizeOptions,"onUpdate:currentPage":t[0]||(t[0]=c=>h(_)({currentPage:c})),"onUpdate:pageSize":t[1]||(t[1]=c=>h(_)({pageSize:c}))},null,8,["current-page","page-size","total-items","total-pages","page-size-options"])]))]))}},vt=U(gt,[["__scopeId","data-v-bbb6276f"]]);export{vt as default};
