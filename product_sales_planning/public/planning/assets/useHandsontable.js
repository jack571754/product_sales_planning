var W=Object.defineProperty;var h=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var v=(T,n,e)=>n in T?W(T,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):T[n]=e,w=(T,n)=>{for(var e in n||(n={}))Y.call(n,e)&&v(T,e,n[e]);if(h)for(var e of h(n))V.call(n,e)&&v(T,e,n[e]);return T};var R=(T,n,e)=>new Promise((d,N)=>{var l=c=>{try{r(e.next(c))}catch(I){N(I)}},_=c=>{try{r(e.throw(c))}catch(I){N(I)}},r=c=>c.done?d(c.value):Promise.resolve(c.value).then(l,_);r((e=e.apply(T,n)).next())});import{p as C,y as z,a6 as k,$ as U,a8 as M}from"./index.js";const y="Common:",x=`${y}ok`,j=`${y}cancel`,J="ContextMenu:items",t=J,Z=`${t}.insertRowAbove`,q=`${t}.insertRowBelow`,K=`${t}.insertColumnOnTheLeft`,Q=`${t}.insertColumnOnTheRight`,ee=`${t}.removeRow`,ne=`${t}.removeColumn`,oe=`${t}.undo`,te=`${t}.redo`,ae=`${t}.readOnly`,le=`${t}.clearColumn`,se=`${t}.copy`,re=`${t}.copyWithHeaders`,Ee=`${t}.copyWithGroupHeaders`,Te=`${t}.copyHeadersOnly`,ce=`${t}.cut`,_e=`${t}.freezeColumn`,Ne=`${t}.unfreezeColumn`,ie=`${t}.mergeCells`,ue=`${t}.unmergeCells`,de=`${t}.addComment`,Se=`${t}.editComment`,Oe=`${t}.removeComment`,Ie=`${t}.readOnlyComment`,Ce=`${t}.align`,Me=`${t}.align.left`,Ae=`${t}.align.center`,Re=`${t}.align.right`,ge=`${t}.align.justify`,Le=`${t}.align.top`,fe=`${t}.align.middle`,me=`${t}.align.bottom`,$e=`${t}.borders`,he=`${t}.borders.top`,ve=`${t}.borders.right`,we=`${t}.borders.bottom`,Ue=`${t}.borders.left`,ye=`${t}.borders.remove`,De=`${t}.nestedHeaders.insertChildRow`,be=`${t}.nestedHeaders.detachFromParent`,Pe=`${t}.hideColumn`,He=`${t}.showColumn`,Fe=`${t}.hideRow`,Xe=`${t}.showRow`,u="Filters:",E=`${u}conditions`,pe=`${E}.none`,Ge=`${E}.isEmpty`,Be=`${E}.isNotEmpty`,We=`${E}.isEqualTo`,Ye=`${E}.isNotEqualTo`,Ve=`${E}.beginsWith`,ze=`${E}.endsWith`,ke=`${E}.contains`,xe=`${E}.doesNotContain`,je=`${E}.greaterThan`,Je=`${E}.greaterThanOrEqualTo`,Ze=`${E}.lessThan`,qe=`${E}.lessThanOrEqualTo`,Ke=`${E}.isBetween`,Qe=`${E}.isNotBetween`,en=`${E}.after`,nn=`${E}.before`,on=`${E}.today`,tn=`${E}.tomorrow`,an=`${E}.yesterday`,ln=`${u}labels.filterByCondition`,sn=`${u}labels.filterByValue`,rn=`${u}labels.conjunction`,En=`${u}labels.disjunction`,Tn=`${u}values.blankCells`,cn=`${u}buttons.selectAll`,_n=`${u}buttons.clear`,Nn=`${u}buttons.ok`,un=`${u}buttons.cancel`,dn=`${u}buttons.placeholder.search`,Sn=`${u}buttons.placeholder.value`,On=`${u}buttons.placeholder.secondValue`,S="Pagination:",In=`${S}section.pagination`,Cn=`${S}.pageSize.auto`,Mn=`${S}section.pageSize`,An=`${S}section.counter`,Rn=`${S}section.navigation`,gn=`${S}firstPage`,Ln=`${S}prevPage`,fn=`${S}nextPage`,mn=`${S}lastPage`,$n="Loading:",hn=`${$n}title`,A="EmptyDataState:",vn=`${A}title`,wn=`${A}description`,Un=`${A}title.filters`,yn=`${A}description.filters`,Dn=`${A}buttons.filters.reset`;/**
 * @preserve
 * Authors: soakit, HChenZi
 * Last updated: Mar 09, 2023
 *
 * Description: Definition file for Chinese - China language-country.
 */const bn={languageCode:"zh-CN",[x]:"ç¡®è®¤",[j]:"å–æ¶ˆ",[Z]:"ä¸Šæ–¹æ’å…¥è¡Œ",[q]:"ä¸‹æ–¹æ’å…¥è¡Œ",[K]:"å·¦æ–¹æ’å…¥åˆ—",[Q]:"å³æ–¹æ’å…¥åˆ—",[ee]:["ç§»é™¤è¯¥è¡Œ","ç§»é™¤å¤šè¡Œ"],[ne]:["ç§»é™¤è¯¥åˆ—","ç§»é™¤å¤šåˆ—"],[oe]:"æ’¤é”€",[te]:"æ¢å¤",[ae]:"åªè¯»",[le]:"æ¸…ç©ºè¯¥åˆ—",[Ce]:"å¯¹é½",[Me]:"å·¦å¯¹é½",[Ae]:"æ°´å¹³å±…ä¸­",[Re]:"å³å¯¹é½",[ge]:"ä¸¤ç«¯å¯¹é½",[Le]:"é¡¶ç«¯å¯¹é½",[fe]:"åž‚ç›´å±…ä¸­",[me]:"åº•ç«¯å¯¹é½",[_e]:"å†»ç»“è¯¥åˆ—",[Ne]:"å–æ¶ˆå†»ç»“",[$e]:"è¾¹æ¡†",[he]:"ä¸Š",[ve]:"å³",[we]:"ä¸‹",[Ue]:"å·¦",[ye]:"ç§»é™¤è¾¹æ¡†",[de]:"æ’å…¥æ‰¹æ³¨",[Se]:"ç¼–è¾‘æ‰¹æ³¨",[Oe]:"åˆ é™¤æ‰¹æ³¨",[Ie]:"åªè¯»æ‰¹æ³¨",[ie]:"åˆå¹¶",[ue]:"å–æ¶ˆåˆå¹¶",[se]:"å¤åˆ¶",[re]:"å¸¦æ ‡é¢˜çš„å¤åˆ¶",[Ee]:"å¸¦æ ‡é¢˜ç»„çš„å¤åˆ¶",[Te]:"ä»…å¤åˆ¶æ ‡é¢˜",[ce]:"å‰ªåˆ‡",[De]:"æ’å…¥å­è¡Œ",[be]:"ä¸Žæ¯è¡Œåˆ†ç¦»",[Pe]:["éšè—è¯¥åˆ—","éšè—å¤šåˆ—"],[He]:["æ˜¾ç¤ºè¯¥åˆ—","æ˜¾ç¤ºå¤šåˆ—"],[Fe]:["éšè—è¯¥è¡Œ","éšè—å¤šè¡Œ"],[Xe]:["æ˜¾ç¤ºè¯¥è¡Œ","æ˜¾ç¤ºå¤šè¡Œ"],[pe]:"æ— ",[Ge]:"ä¸ºç©º",[Be]:"ä¸ä¸ºç©º",[We]:"ç­‰äºŽ",[Ye]:"ä¸ç­‰äºŽ",[Ve]:"å¼€å¤´æ˜¯",[ze]:"ç»“å°¾æ˜¯",[ke]:"åŒ…å«",[xe]:"ä¸åŒ…å«",[je]:"å¤§äºŽ",[Je]:"å¤§äºŽæˆ–ç­‰äºŽ",[Ze]:"å°äºŽ",[qe]:"å°äºŽæˆ–ç­‰äºŽ",[Ke]:"åœ¨æ­¤èŒƒå›´",[Qe]:"ä¸åœ¨æ­¤èŒƒå›´",[en]:"ä¹‹åŽ",[nn]:"ä¹‹å‰",[on]:"ä»Šå¤©",[tn]:"æ˜Žå¤©",[an]:"æ˜¨å¤©",[Tn]:"ç©ºç™½å•å…ƒæ ¼",[ln]:"æŒ‰æ¡ä»¶è¿‡æ»¤",[sn]:"æŒ‰å€¼è¿‡æ»¤",[rn]:"ä¸”",[En]:"æˆ–",[cn]:"å…¨é€‰",[_n]:"æ¸…é™¤",[Nn]:"ç¡®è®¤",[un]:"å–æ¶ˆ",[dn]:"æœç´¢",[Sn]:"å€¼",[On]:"ç¬¬äºŒå€¼",[In]:"åˆ†é¡µ",[Mn]:"æ¯é¡µè¡Œæ•°",[Cn]:"è‡ªåŠ¨",[An]:"[start] - [end] å…± [total]",[Rn]:"ç¬¬ [currentPage] é¡µï¼Œå…± [totalPages] é¡µ",[gn]:"è½¬åˆ°ç¬¬ä¸€é¡µ",[Ln]:"è½¬åˆ°ä¸Šä¸€é¡µ",[fn]:"è½¬åˆ°ä¸‹ä¸€é¡µ",[mn]:"è½¬åˆ°æœ€åŽä¸€é¡µ",[hn]:"åŠ è½½ä¸­...",[vn]:"æš‚æ— æ•°æ®",[wn]:"æš‚æ— å†…å®¹å¯æ˜¾ç¤ºã€‚",[Un]:"æœªæ‰¾åˆ°ç»“æžœ",[yn]:"çœ‹èµ·æ¥æ‚¨å½“å‰çš„è¿‡æ»¤å™¨éšè—äº†æ‰€æœ‰ç»“æžœã€‚",[Dn]:"é‡ç½®è¿‡æ»¤å™¨"};function Pn(){if(!window.Handsontable||!window.Handsontable.languages)return;const T="zh-CN",n=window.Handsontable.languages.getLanguageDictionary(T);if(!(n&&n.languageCode===T))try{window.Handsontable.languages.registerLanguageDictionary(bn)}catch(e){console.warn("âš ï¸ æ³¨å†Œ Handsontable ä¸­æ–‡è¯­è¨€åŒ…å¤±è´¥",e)}}function Hn(){return new Promise((T,n)=>{if(window.Handsontable){console.log("âœ… Handsontable already loaded"),T();return}const e=(N,l)=>new Promise((_,r)=>{if(document.getElementById(N)){_();return}const c=document.createElement("link");c.id=N,c.rel="stylesheet",c.href=l,c.onload=()=>{console.log(`âœ… CSS loaded: ${l}`),_()},c.onerror=()=>r(new Error(`Failed to load CSS: ${l}`)),document.head.appendChild(c)}),d=N=>new Promise((l,_)=>{if(window.Handsontable){l();return}const r=document.createElement("script");r.src=N,r.onload=()=>{console.log(`âœ… JS loaded: ${N}`),l()},r.onerror=()=>_(new Error(`Failed to load JS: ${N}`)),document.head.appendChild(r)});Promise.resolve().then(()=>e("handsontable-css","/assets/product_sales_planning/js/lib/handsontable.full.min.css")).then(()=>d("/assets/product_sales_planning/js/lib/handsontable.full.min.js")).then(()=>{console.log("âœ… All Handsontable resources loaded"),Pn(),T()}).catch(n),setTimeout(()=>{n(new Error("Handsontable èµ„æºåŠ è½½è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–åˆ·æ–°é¡µé¢"))},1e4)})}function pn(T,n={}){const e=C(null),d=C(!0),N=C(null),l=C(!1),_=C(new Set),r=a=>{if(a==null)return a;if(typeof a=="object"&&"value"in a)return a.value;if(typeof a=="function")try{return a()}catch(o){return console.warn("âš ï¸ Failed to resolve function value:",o),a}return a},c=()=>R(this,null,function*(){try{if(d.value=!0,N.value=null,yield Hn(),!T.value)throw new Error("Container element not found");if(!T.value.parentNode)throw new Error("Container element not mounted to DOM");if(!window.Handsontable)throw new Error("Handsontable library not loaded");if(e.value&&!l.value)try{e.value.destroy(),e.value=null,console.log("âœ… Old Handsontable instance destroyed")}catch(s){console.warn("âš ï¸ Failed to destroy old instance:",s)}const a=w({data:r(n.data)||[],columns:r(n.columns)||[],colHeaders:r(n.colHeaders)||!0,rowHeaders:r(n.rowHeaders)!==!1,fixedColumnsLeft:n.fixedColumnsLeft!==void 0?n.fixedColumnsLeft:3,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!1,autoWrapCol:!1,manualColumnResize:!0,manualRowResize:!0,manualRowMove:!1,manualColumnMove:!1,contextMenu:n.contextMenu!==!1?{items:{row_above:{name:"åœ¨ä¸Šæ–¹æ’å…¥è¡Œ"},row_below:{name:"åœ¨ä¸‹æ–¹æ’å…¥è¡Œ"},separator1:"---------",remove_row:{name:"åˆ é™¤é€‰ä¸­è¡Œ",disabled:()=>_.value.size===0},separator2:"---------",undo:{name:"æ’¤é”€"},redo:{name:"é‡åš"},separator3:"---------",make_read_only:{name:"è®¾ä¸ºåªè¯»"},alignment:{name:"å¯¹é½æ–¹å¼"},separator4:"---------",copy:{name:"å¤åˆ¶"},cut:{name:"å‰ªåˆ‡"}}}:!1,dropdownMenu:n.dropdownMenu!==!1?["filter_by_condition","filter_by_value","filter_action_bar","alignment"]:!1,filters:n.filters!==!1,columnSorting:n.columnSorting!==!1,sortIndicator:!0,hiddenColumns:{indicators:!0,columns:r(n.hiddenColumns)||[],copyPasteEnabled:!0},copyPaste:!0,renderAllRows:!1,viewportRowRenderingOffset:30,viewportColumnRenderingOffset:10,selectionMode:"multiple",language:"zh-CN",wordWrap:!1,afterChange:(s,i)=>{i!=="loadData"&&n.onDataChange&&n.onDataChange(s,i)},afterSelection:(s,i,O,$)=>{n.onSelection&&n.onSelection(s,i,O,$)},afterSelectionEnd:(s,i,O,$)=>{const G=Math.min(s,O),B=Math.max(s,O),g=new Set;for(let L=G;L<=B;L++)g.add(L);_.value=g,n.onSelectionChange&&n.onSelectionChange(Array.from(g))},afterDeselect:()=>{_.value=new Set,n.onSelectionChange&&n.onSelectionChange([])}},n.config?Object.keys(n.config).reduce((s,i)=>(s[i]=r(n.config[i]),s),{}):{});e.value=new window.Handsontable(T.value,a),l.value=!1,console.log("âœ… Handsontable initialized successfully"),d.value=!1,yield M(),yield M();const o=r(n.data);console.log("ðŸ“¦ Attempting to load initial data:",{hasData:!!o,isArray:Array.isArray(o),length:o==null?void 0:o.length,sampleRow:o==null?void 0:o[0]}),o&&Array.isArray(o)&&o.length>0?(console.log("âœ… Loading initial data:",o.length,"rows"),I(o)):console.warn("âš ï¸ No initial data to load, will wait for watch trigger")}catch(a){console.error("âŒ Handsontable initialization error:",a),N.value=a.message,d.value=!1}}),I=a=>{if(console.log("ðŸ”„ updateData called:",{hasInstance:!!e.value,isDestroyed:l.value,isLoading:d.value,dataLength:a==null?void 0:a.length,dataType:typeof a,isArray:Array.isArray(a),sampleData:a==null?void 0:a[0]}),!e.value||l.value){console.warn("âš ï¸ Cannot update data - instance not ready:",{hasInstance:!!e.value,isDestroyed:l.value});return}if(!a||!Array.isArray(a)){console.warn("âš ï¸ Invalid data provided:",a);return}try{const o=a.map(s=>{const i={};for(const O in s)Object.prototype.hasOwnProperty.call(s,O)&&(i[O]=s[O]);return i});console.log("ðŸ“¦ Loading data into Handsontable:",{rowCount:o.length,columnCount:Object.keys(o[0]||{}).length,firstRow:o[0]}),e.value.loadData(o),M(()=>{if(e.value&&!l.value){e.value.render(),console.log("âœ… Data loaded and rendered successfully");const s=e.value.countRows(),i=e.value.countCols();console.log("ðŸ“Š Rendered table size:",{rows:s,cols:i}),s===0&&console.error("âŒ Table rendered but has 0 rows!")}})}catch(o){console.error("âŒ Error loading data:",o),console.error("Error stack:",o.stack)}},f=a=>{e.value&&!l.value&&e.value.updateSettings({columns:a})},D=()=>e.value&&!l.value?e.value.getData():[],b=(a,o)=>e.value&&!l.value?e.value.getDataAtCell(a,o):null,P=(a,o,s)=>{e.value&&!l.value&&e.value.setDataAtCell(a,o,s)},H=()=>{e.value&&!l.value&&e.value.render()},F=()=>Array.from(_.value),X=()=>{_.value=new Set,e.value&&!l.value&&e.value.deselectCell(),n.onSelectionChange&&n.onSelectionChange([])},p=()=>{if(e.value&&!l.value){const a=e.value.countRows(),o=new Set;for(let s=0;s<a;s++)o.add(s);if(_.value=o,a>0){const s=e.value.countCols();e.value.selectCell(0,0,a-1,s-1)}n.onSelectionChange&&n.onSelectionChange(Array.from(o))}},m=()=>{e.value&&!l.value&&(e.value.destroy(),e.value=null,l.value=!0,_.value=new Set,console.log("âœ… Handsontable destroyed"))};return z(()=>{c()}),k(()=>{m()}),n.data&&U(()=>n.data,a=>R(this,null,function*(){const o=r(a);if(console.log("ðŸ‘€ Data watch triggered:",{hasData:!!o,dataLength:o==null?void 0:o.length,hasInstance:!!e.value,isLoading:d.value,isDestroyed:l.value}),!e.value||d.value||l.value){console.log("â³ Waiting for instance to be ready...");return}o&&Array.isArray(o)&&o.length>0?(yield M(),console.log("ðŸ”„ Auto-updating data from watch:",o.length,"rows"),I(o)):console.warn("âš ï¸ Watch triggered but no valid data:",o)}),{deep:!1,immediate:!0}),n.columns&&U(()=>n.columns,a=>R(this,null,function*(){const o=r(a);o&&Array.isArray(o)&&e.value&&!d.value&&!l.value&&(yield M(),f(o))}),{deep:!1,immediate:!1}),{hotInstance:e,loading:d,error:N,selectedRows:_,updateData:I,updateColumns:f,getData:D,getDataAtCell:b,setDataAtCell:P,render:H,destroy:m,getSelectedRows:F,clearSelection:X,selectAllRows:p}}export{pn as u};
